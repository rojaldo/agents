= Temario Completo: n8n - AutomatizaciÃ³n de Workflows
:doctype: book
:toc:
:toclevels: 4
:sectnums:
:icons: font
:source-highlighter: highlight.js
:highlightjsdir: https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0
:highlightjs-theme: atom-one-light
:data-uri:

[preface]
== IntroducciÃ³n a n8n

n8n es una plataforma de cÃ³digo abierto para automatizaciÃ³n de workflows que permite conectar aplicaciones y servicios sin escribir cÃ³digo complejo. Este temario cubre desde conceptos bÃ¡sicos hasta implementaciones avanzadas en producciÃ³n.

---

== MÃ“DULO 1: Fundamentos de n8n

=== 1.1 Â¿QuÃ© es n8n?

==== DefiniciÃ³n y caracterÃ­sticas principales

**n8n** (pronunciado "n-eight-n") es una plataforma de automatizaciÃ³n de workflows de cÃ³digo abierto que permite conectar aplicaciones, servicios y APIs sin necesidad de escribir cÃ³digo complejo. Su nombre proviene de la palabra "nodemation" (node + automation).

**CaracterÃ­sticas principales:**

* **Visual Workflow Builder**: Editor visual basado en nodos que permite crear flujos de trabajo de manera intuitiva mediante drag-and-drop
* **CÃ³digo Abierto**: Licencia fair-code, permitiendo revisar y modificar el cÃ³digo fuente
* **Self-hosted**: Control total sobre tus datos al alojar n8n en tu propia infraestructura
* **Extensible**: MÃ¡s de 400+ integraciones nativas y posibilidad de crear nodos personalizados
* **Flexible**: Soporta JavaScript, Python y expresiones personalizadas para lÃ³gica compleja
* **REST API**: API completa para gestionar workflows programÃ¡ticamente

==== ComparaciÃ³n con otras plataformas

[cols="1,1,1,1", options="header"]
|===
|CaracterÃ­stica|n8n|Zapier|Make (Integromat)

|Tipo
|Open Source
|SaaS Propietario
|SaaS Propietario

|Hosting
|Self-hosted / Cloud
|Solo Cloud
|Solo Cloud

|Precio
|Gratis (self-hosted)
|Desde $20/mes
|Desde $9/mes

|Privacidad de datos
|Total (self-hosted)
|Limitada
|Limitada

|Nodos personalizados
|SÃ­
|No
|Limitado

|CÃ³digo JavaScript/Python
|SÃ­
|No
|Limitado

|Complejidad workflows
|Alta
|Media
|Alta

|Curva de aprendizaje
|Media
|Baja
|Media-Alta
|===

==== Ventajas de n8n

**1. CÃ³digo Abierto y Transparencia**
* Auditable: puedes revisar exactamente quÃ© hace cada nodo
* Comunidad activa: contribuciones constantes y mejoras
* Sin vendor lock-in: libertad para migrar o modificar

**2. Self-hosted y Control de Datos**
* Datos sensibles permanecen en tu infraestructura
* Cumplimiento con GDPR, HIPAA y otras regulaciones
* Sin lÃ­mites de ejecuciÃ³n o transferencia de datos

**3. Escalabilidad**
* Horizontal: mÃºltiples workers para distribuir carga
* Vertical: ajustar recursos segÃºn necesidades
* Queue system: gestiÃ³n eficiente de workflows concurrentes

**4. Flexibilidad TÃ©cnica**
* Code nodes para lÃ³gica compleja en JavaScript/Python
* Expresiones personalizadas con sintaxis similar a JavaScript
* HTTP Request node universal para cualquier API

**5. Costo-Efectivo**
* Gratis para instalaciones self-hosted
* Sin costos por ejecuciÃ³n o transferencia de datos
* Cloud version con precios competitivos

==== Casos de uso reales

**1. AutomatizaciÃ³n de Marketing**
* Sincronizar leads entre CRM y herramientas de email marketing
* Enviar emails personalizados basados en comportamiento del usuario
* Publicar contenido automÃ¡ticamente en redes sociales

**2. IntegraciÃ³n de Sistemas**
* ETL: Extraer datos de mÃºltiples fuentes, transformar y cargar en data warehouse
* SincronizaciÃ³n bidireccional entre ERP y e-commerce
* Integrar sistemas legacy con aplicaciones modernas

**3. DevOps y Monitoreo**
* Notificaciones de alertas de monitoreo en Slack/Teams
* Deployment automÃ¡tico tras merge en repositorio
* RecolecciÃ³n de mÃ©tricas y generaciÃ³n de reportes

**4. Procesamiento de Datos**
* Scraping de sitios web y almacenamiento en base de datos
* Procesamiento de archivos CSV/Excel y distribuciÃ³n
* ValidaciÃ³n y limpieza de datos en tiempo real

**5. AtenciÃ³n al Cliente**
* Crear tickets automÃ¡ticamente desde emails/formularios
* Enriquecer informaciÃ³n de clientes desde mÃºltiples fuentes
* Automatizar respuestas basadas en keywords

**6. E-commerce**
* Sincronizar inventario entre plataformas
* Procesar pedidos y notificar a sistemas de fulfillment
* Generar reportes de ventas y enviarlos diariamente

=== 1.2 InstalaciÃ³n y ConfiguraciÃ³n Inicial

==== Requisitos del sistema

**MÃ­nimos:**
* CPU: 2 cores
* RAM: 2 GB
* Disco: 10 GB
* Node.js: v18.x o superior (para instalaciÃ³n local)
* Docker: v20.x o superior (para instalaciÃ³n con contenedores)

**Recomendados para producciÃ³n:**
* CPU: 4+ cores
* RAM: 4+ GB
* Disco: 50+ GB (dependiendo de volumen de ejecuciones)
* PostgreSQL: v12+ (para persistencia en producciÃ³n)

==== InstalaciÃ³n con Docker

**OpciÃ³n 1: Docker Run (bÃ¡sico)**

[source,bash]
----
# Ejecutar n8n con SQLite (desarrollo)
docker run -it --rm \
  --name n8n \
  -p 5678:5678 \
  -v ~/.n8n:/home/node/.n8n \
  n8nio/n8n
----

**OpciÃ³n 2: Docker Compose (recomendado)**

Crear archivo `docker-compose.yml`:

[source,yaml]
----
version: '3.8'

services:
  n8n:
    image: n8nio/n8n:latest
    container_name: n8n
    restart: unless-stopped
    ports:
      - "5678:5678"
    environment:
      - N8N_BASIC_AUTH_ACTIVE=true
      - N8N_BASIC_AUTH_USER=admin
      - N8N_BASIC_AUTH_PASSWORD=changeme
      - N8N_HOST=localhost
      - N8N_PORT=5678
      - N8N_PROTOCOL=http
      - WEBHOOK_URL=http://localhost:5678/
      - GENERIC_TIMEZONE=Europe/Madrid
    volumes:
      - n8n_data:/home/node/.n8n

volumes:
  n8n_data:
    driver: local
----

Iniciar con:
[source,bash]
----
docker-compose up -d
----

**OpciÃ³n 3: Docker Compose con PostgreSQL (producciÃ³n)**

Ver archivo completo en: `./ejemplos/n8n/docker-compose-postgres.yml`

[source,yaml]
----
version: '3.8'

services:
  postgres:
    image: postgres:15-alpine
    container_name: n8n_postgres
    restart: unless-stopped
    environment:
      - POSTGRES_USER=n8n
      - POSTGRES_PASSWORD=n8n_secure_password
      - POSTGRES_DB=n8n
    volumes:
      - postgres_data:/var/lib/postgresql/data
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U n8n"]
      interval: 10s
      timeout: 5s
      retries: 5

  n8n:
    image: n8nio/n8n:latest
    container_name: n8n_app
    restart: unless-stopped
    ports:
      - "5678:5678"
    environment:
      - DB_TYPE=postgresdb
      - DB_POSTGRESDB_HOST=postgres
      - DB_POSTGRESDB_PORT=5432
      - DB_POSTGRESDB_DATABASE=n8n
      - DB_POSTGRESDB_USER=n8n
      - DB_POSTGRESDB_PASSWORD=n8n_secure_password
      - N8N_BASIC_AUTH_ACTIVE=true
      - N8N_BASIC_AUTH_USER=admin
      - N8N_BASIC_AUTH_PASSWORD=changeme123
      - N8N_HOST=localhost
      - N8N_PORT=5678
      - N8N_PROTOCOL=http
      - WEBHOOK_URL=http://localhost:5678/
      - GENERIC_TIMEZONE=Europe/Madrid
      - EXECUTIONS_DATA_PRUNE=true
      - EXECUTIONS_DATA_MAX_AGE=168
    volumes:
      - n8n_data:/home/node/.n8n
    depends_on:
      postgres:
        condition: service_healthy

volumes:
  postgres_data:
    driver: local
  n8n_data:
    driver: local
----

==== InstalaciÃ³n local (Node.js)

**Requisitos previos:**
[source,bash]
----
# Verificar versiÃ³n de Node.js
node --version  # Debe ser v18 o superior

# Verificar npm
npm --version
----

**InstalaciÃ³n global:**
[source,bash]
----
# Instalar n8n globalmente
npm install n8n -g

# Iniciar n8n
n8n start

# O con configuraciÃ³n personalizada
n8n start --tunnel
----

**InstalaciÃ³n local en proyecto:**
[source,bash]
----
# Crear directorio del proyecto
mkdir mi-n8n-app
cd mi-n8n-app

# Inicializar npm
npm init -y

# Instalar n8n
npm install n8n

# Agregar script en package.json
# "scripts": { "start": "n8n start" }

# Ejecutar
npm start
----

==== InstalaciÃ³n en la nube

**AWS EC2:**
[source,bash]
----
# Conectar a instancia EC2
ssh -i mi-clave.pem ubuntu@mi-instancia.amazonaws.com

# Instalar Docker
sudo apt update
sudo apt install -y docker.io docker-compose

# Clonar configuraciÃ³n o crear docker-compose.yml
# Iniciar n8n
sudo docker-compose up -d

# Configurar seguridad (security group)
# Abrir puerto 5678 o configurar reverse proxy con nginx
----

**DigitalOcean Droplet:**
[source,bash]
----
# Crear droplet Ubuntu 22.04
# Conectar via SSH

# OpciÃ³n 1: One-click Docker app desde marketplace
# OpciÃ³n 2: InstalaciÃ³n manual con Docker

# Instalar Docker
curl -fsSL https://get.docker.com -o get-docker.sh
sh get-docker.sh

# Iniciar n8n
docker run -d \
  --name n8n \
  --restart unless-stopped \
  -p 5678:5678 \
  -v n8n_data:/home/node/.n8n \
  n8nio/n8n
----

**Heroku:**
[source,bash]
----
# Instalar Heroku CLI
# https://devcenter.heroku.com/articles/heroku-cli

# Login
heroku login

# Crear app
heroku create mi-n8n-app

# Agregar PostgreSQL addon
heroku addons:create heroku-postgresql:hobby-dev

# Configurar variables de entorno
heroku config:set N8N_BASIC_AUTH_ACTIVE=true
heroku config:set N8N_BASIC_AUTH_USER=admin
heroku config:set N8N_BASIC_AUTH_PASSWORD=secure123

# Deploy
git push heroku main
----

==== Acceso a la interfaz web

Una vez instalado y ejecutado, acceder a:

* **Local**: http://localhost:5678
* **Con tunnel**: URL proporcionada por n8n (ej: https://xxxxx.tunnel.n8n.cloud)
* **ProducciÃ³n**: https://tu-dominio.com

**Primera vez:**
1. Crear cuenta de usuario (si no hay Basic Auth)
2. Configurar email y contraseÃ±a
3. Explorar la interfaz

==== ConfiguraciÃ³n bÃ¡sica de seguridad

**1. AutenticaciÃ³n bÃ¡sica:**
[source,bash]
----
export N8N_BASIC_AUTH_ACTIVE=true
export N8N_BASIC_AUTH_USER=admin
export N8N_BASIC_AUTH_PASSWORD=password_muy_seguro
----

**2. Variables de entorno importantes:**
[source,bash]
----
# Deshabilitar registro de nuevos usuarios
export N8N_PERSONALIZATION_ENABLED=false

# Restringir acceso a workflows
export N8N_USER_MANAGEMENT_DISABLED=false

# Configurar HTTPS
export N8N_PROTOCOL=https
export N8N_HOST=mi-dominio.com

# Webhook URL segura
export WEBHOOK_URL=https://mi-dominio.com/
----

**3. Reverse Proxy con Nginx (recomendado para producciÃ³n):**
[source,nginx]
----
server {
    listen 80;
    server_name n8n.mi-dominio.com;
    return 301 https://$server_name$request_uri;
}

server {
    listen 443 ssl http2;
    server_name n8n.mi-dominio.com;

    ssl_certificate /etc/letsencrypt/live/n8n.mi-dominio.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/n8n.mi-dominio.com/privkey.pem;

    location / {
        proxy_pass http://localhost:5678;
        proxy_set_header Connection '';
        proxy_http_version 1.1;
        chunked_transfer_encoding off;
        proxy_buffering off;
        proxy_cache off;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
----

**4. Firewall bÃ¡sico (UFW en Ubuntu):**
[source,bash]
----
# Permitir solo SSH y HTTP/HTTPS
sudo ufw allow OpenSSH
sudo ufw allow 'Nginx Full'
sudo ufw enable

# Bloquear acceso directo al puerto 5678
sudo ufw deny 5678
----

=== 1.3 Interfaz de Usuario

==== VisiÃ³n general de la interfaz

La interfaz de n8n se divide en varias Ã¡reas principales que facilitan la creaciÃ³n y gestiÃ³n de workflows.

[source,text]
----
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  n8n                                    [User] [Settings] [?]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Workflows  â”‚                                                     â”‚
â”‚ Executions â”‚              CANVAS (Ãrea de trabajo)              â”‚
â”‚ Templates  â”‚                                                     â”‚
â”‚            â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”           â”‚
â”‚            â”‚    â”‚Start â”‚â”€â”€â”€â”€â”€>â”‚HTTP  â”‚â”€â”€â”€â”€â”€>â”‚Email â”‚           â”‚
â”‚            â”‚    â””â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚            â”‚                                                     â”‚
â”‚            â”‚                                                     â”‚
â”‚ Panel de   â”‚                                                     â”‚
â”‚ Nodos      â”‚                                                     â”‚
â”‚            â”‚                                                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”‚                                                     â”‚
â”‚ â”‚Trigger â”‚ â”‚              [Execute Workflow]                    â”‚
â”‚ â”‚HTTP    â”‚ â”‚                                                     â”‚
â”‚ â”‚Scheduleâ”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”‚Webhook â”‚ â”‚             INSPECTOR DE PROPIEDADES               â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  Node: HTTP Request                                â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â€¢ Method: GET                                     â”‚
â”‚ â”‚Actions â”‚ â”‚  â€¢ URL: https://api.example.com                    â”‚
â”‚ â”‚Email   â”‚ â”‚  â€¢ Authentication: None                            â”‚
â”‚ â”‚Slack   â”‚ â”‚  â€¢ Options: ...                                    â”‚
â”‚ â”‚HTTP    â”‚ â”‚                                                     â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
----

==== Panel de control principal

**Barra superior:**
* **Logo n8n**: Acceso rÃ¡pido al home
* **Nombre del workflow**: Editable al hacer click
* **Usuario**: Perfil y configuraciÃ³n de cuenta
* **Settings**: ConfiguraciÃ³n global de n8n
* **Help**: DocumentaciÃ³n y recursos

**MenÃº lateral izquierdo:**
* **Workflows**: Lista de todos los workflows creados
* **Executions**: Historial de ejecuciones
* **Credentials**: GestiÃ³n de credenciales y autenticaciones
* **Variables**: Variables de entorno globales
* **Templates**: Plantillas de la comunidad

==== Ãrea de trabajo (Canvas)

El canvas es el Ã¡rea principal donde construyes visualmente tus workflows.

**CaracterÃ­sticas:**
* **Zoom**: Controles de zoom (+/-) o rueda del ratÃ³n
* **Pan**: Arrastrar con click central o barra espaciadora + arrastrar
* **Grid snapping**: Los nodos se alinean automÃ¡ticamente
* **Minimap**: Vista previa del workflow completo (workflows grandes)

**Interacciones:**
* **Agregar nodo**: Click en el botÃ³n "+" entre nodos o en el panel lateral
* **Conectar nodos**: Arrastrar desde el punto de conexiÃ³n (cÃ­rculo a la derecha)
* **Mover nodos**: Arrastrar el nodo
* **Eliminar**: Seleccionar y presionar Delete/Backspace
* **Copiar/Pegar**: Ctrl+C / Ctrl+V
* **Deshacer/Rehacer**: Ctrl+Z / Ctrl+Shift+Z

**Diagrama de flujo de datos:**
[source,text]
----
    Trigger               AcciÃ³n               AcciÃ³n
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚         â”‚          â”‚         â”‚          â”‚         â”‚
   â”‚ Webhook â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚ Filter  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚  Email  â”‚
   â”‚         â”‚  datos   â”‚  Data   â”‚  datos   â”‚  Send   â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ datos filtrados
                             â–¼
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚Database â”‚
                        â”‚  Save   â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
----

==== Panel de nodos

El panel de nodos muestra todos los nodos disponibles organizados por categorÃ­as.

**CategorÃ­as principales:**
* **Triggers**: Nodos que inician workflows
  - Manual Trigger
  - Webhook
  - Schedule Trigger
  - Email Trigger
  - etc.

* **Actions**: Nodos que realizan acciones
  - HTTP Request
  - Email Send
  - Slack
  - Database operations
  - File operations

* **Core Nodes**: Nodos de lÃ³gica y control
  - IF
  - Switch
  - Merge
  - Split
  - Set
  - Code

* **Data Transformation**: Nodos para transformar datos
  - Item Lists
  - Aggregate
  - Sort
  - Filter

**BÃºsqueda de nodos:**
[source,text]
----
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ” Search nodes...    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âš¡ Triggers            â”‚
â”‚   â€¢ Webhook            â”‚
â”‚   â€¢ Schedule           â”‚
â”‚   â€¢ Email Trigger      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ”§ Actions             â”‚
â”‚   â€¢ HTTP Request       â”‚
â”‚   â€¢ Email Send         â”‚
â”‚   â€¢ Slack              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ¯ Core                â”‚
â”‚   â€¢ IF                 â”‚
â”‚   â€¢ Switch             â”‚
â”‚   â€¢ Code               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
----

==== Inspector de propiedades

El inspector se abre al hacer click en un nodo y muestra todas sus configuraciones.

**Secciones comunes:**
* **Parameters**: ParÃ¡metros principales del nodo
* **Settings**: Configuraciones avanzadas
  - Node name: Nombre personalizado
  - Notes: Notas y documentaciÃ³n
  - Continue On Fail: No detener workflow si falla
  - Retry On Fail: Reintentar automÃ¡ticamente
  - Always Output Data: Forzar salida de datos

**Ejemplo de inspector HTTP Request:**
[source,text]
----
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ HTTP Request                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Parameters                     â”‚
â”‚                                â”‚
â”‚ Method:                        â”‚
â”‚ [â–¼ GET                      ]  â”‚
â”‚                                â”‚
â”‚ URL:                           â”‚
â”‚ [https://api.example.com    ]  â”‚
â”‚                                â”‚
â”‚ Authentication:                â”‚
â”‚ [â–¼ None                     ]  â”‚
â”‚                                â”‚
â”‚ Query Parameters:              â”‚
â”‚ [ Add Parameter            ]   â”‚
â”‚                                â”‚
â”‚ Headers:                       â”‚
â”‚ [ Add Header               ]   â”‚
â”‚                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Settings                       â”‚
â”‚ â˜‘ Continue On Fail            â”‚
â”‚ â˜ Retry On Fail               â”‚
â”‚ Timeout: 300s                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
----

**Expresiones:**
En cualquier campo puedes usar expresiones para datos dinÃ¡micos:
[source,text]
----
Campo normal:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ john@example.com           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Campo con expresiÃ³n:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ = {{$json.email}}         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
----

==== Panel de ejecuciÃ³n

Cuando ejecutas un workflow, se muestra informaciÃ³n detallada de la ejecuciÃ³n.

**InformaciÃ³n mostrada:**
* **Status**: Success, Error, Running
* **Execution time**: DuraciÃ³n total
* **Data flow**: Datos que pasan entre nodos
* **Output data**: Datos de salida de cada nodo
* **Error messages**: Mensajes de error si falla

**VisualizaciÃ³n de datos:**
[source,text]
----
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Execution #1234                         â”‚
â”‚ Status: âœ“ Success                       â”‚
â”‚ Time: 2.3s                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚ Webhook (Item 1)                        â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ {                                   â”‚ â”‚
â”‚ â”‚   "name": "John Doe",              â”‚ â”‚
â”‚ â”‚   "email": "john@example.com",     â”‚ â”‚
â”‚ â”‚   "message": "Hello World"         â”‚ â”‚
â”‚ â”‚ }                                   â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚          â–¼                              â”‚
â”‚ HTTP Request (Item 1)                   â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ {                                   â”‚ â”‚
â”‚ â”‚   "status": 200,                   â”‚ â”‚
â”‚ â”‚   "data": {...}                    â”‚ â”‚
â”‚ â”‚ }                                   â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
----

**Modos de visualizaciÃ³n:**
* **JSON**: Vista de datos en formato JSON
* **Table**: Vista tabular para mÃºltiples items
* **Binary**: Vista de datos binarios (imÃ¡genes, archivos)
* **Raw**: Vista raw sin formato

==== Historial de ejecuciones

Accesible desde el menÃº lateral, muestra todas las ejecuciones pasadas.

**InformaciÃ³n disponible:**
* **Workflow name**: Nombre del workflow ejecutado
* **Status**: Estado final (Success, Error, Waiting)
* **Start time**: Fecha y hora de inicio
* **Execution time**: DuraciÃ³n
* **Mode**: Manual, Trigger, Webhook, etc.

**Tabla de ejecuciones:**
[source,text]
----
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Executions                                    [Filter] [Delete] â”‚
â”œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ID â”‚ Workflow     â”‚ Status  â”‚ Start Time   â”‚ Duration â”‚ Mode   â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚1234â”‚Send Email    â”‚âœ“ Successâ”‚2025-01-15... â”‚   2.3s   â”‚Webhook â”‚
â”‚1233â”‚Process Data  â”‚âœ— Error  â”‚2025-01-15... â”‚   1.1s   â”‚Manual  â”‚
â”‚1232â”‚Daily Report  â”‚âœ“ Successâ”‚2025-01-15... â”‚  45.7s   â”‚Scheduleâ”‚
â”‚1231â”‚Send Email    â”‚âœ“ Successâ”‚2025-01-15... â”‚   2.1s   â”‚Webhook â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
----

**Filtros disponibles:**
* Por status: Success, Error, Waiting
* Por fecha: Ãšltima hora, dÃ­a, semana, mes
* Por workflow: Seleccionar workflow especÃ­fico
* Por modo: Manual, Trigger, Webhook, etc.

==== Atajos de teclado Ãºtiles

[cols="1,2", options="header"]
|===
|Atajo|AcciÃ³n

|Ctrl/Cmd + S
|Guardar workflow

|Ctrl/Cmd + Enter
|Ejecutar workflow

|Ctrl/Cmd + C
|Copiar nodo seleccionado

|Ctrl/Cmd + V
|Pegar nodo

|Ctrl/Cmd + Z
|Deshacer

|Ctrl/Cmd + Shift + Z
|Rehacer

|Delete/Backspace
|Eliminar nodo seleccionado

|Ctrl/Cmd + A
|Seleccionar todos los nodos

|Tab
|Abrir bÃºsqueda de nodos

|Esc
|Cerrar panel/modal

|Space + Drag
|Pan por el canvas

|Ctrl/Cmd + Scroll
|Zoom in/out
|===

=== 1.4 Conceptos Fundamentales

==== Workflows (flujos de trabajo)

Un **workflow** es una secuencia de pasos automatizados que se ejecutan en orden para completar una tarea especÃ­fica.

**Componentes de un workflow:**
* **Nombre**: Identificador Ãºnico y descriptivo
* **DescripciÃ³n**: DocumentaciÃ³n del propÃ³sito
* **Nodos**: Elementos individuales que realizan acciones
* **Conexiones**: Enlaces que determinan el flujo de datos
* **Trigger**: Punto de inicio del workflow
* **Settings**: ConfiguraciÃ³n global del workflow

**Ciclo de vida de un workflow:**
[source,text]
----
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Trigger â”‚â”€â”€â”€â”€>â”‚ Process  â”‚â”€â”€â”€â”€>â”‚ Process  â”‚â”€â”€â”€â”€>â”‚  End    â”‚
â”‚ (Inicio)â”‚     â”‚  Data    â”‚     â”‚  Data    â”‚     â”‚         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â–²                                                   â”‚
     â”‚                                                   â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Loop/Retry â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
----

**Estados de un workflow:**
* **Inactive**: No estÃ¡ ejecutÃ¡ndose
* **Active**: Activado y esperando trigger
* **Running**: En ejecuciÃ³n actual
* **Error**: FallÃ³ durante la ejecuciÃ³n
* **Success**: Completado exitosamente

**Ejemplo bÃ¡sico - Estructura JSON:**
Ver archivo completo: `./ejemplos/n8n/01-workflow-basico.json`

==== Nodos y conexiones

**Nodos:**
Los nodos son los bloques de construcciÃ³n de n8n. Cada nodo realiza una tarea especÃ­fica.

**Tipos de nodos:**
* **Trigger nodes**: Inician el workflow
* **Regular nodes**: Procesan o transforman datos
* **Conditional nodes**: Toman decisiones (IF, Switch)
* **Merge nodes**: Combinan datos de mÃºltiples fuentes

**AnatomÃ­a de un nodo:**
[source,text]
----
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âš¡ HTTP Request              â”‚  â† Nombre del nodo
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
â”‚  URL: api.example.com         â”‚  â† ConfiguraciÃ³n
â”‚  Method: GET                  â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
â”‚  â— Input  â”‚  Output â—        â”‚  â† Puntos de conexiÃ³n
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
----

**Conexiones:**
Las conexiones determinan cÃ³mo fluyen los datos entre nodos.

[source,text]
----
ConexiÃ³n simple:
Node A â”€â”€â”€â”€â”€â”€> Node B

ConexiÃ³n condicional (IF):
              â”Œâ”€â”€> Node B (true)
Node A â”€â”€â”€â”€â”€â”€â”€â”¤
              â””â”€â”€> Node C (false)

ConexiÃ³n mÃºltiple (mÃºltiples outputs):
         â”Œâ”€â”€> Node B
Node A â”€â”€â”¼â”€â”€> Node C
         â””â”€â”€> Node D
----

**Flujo de datos:**
Los datos se pasan de nodo a nodo como un array de items:
[source,json]
----
[
  {
    "json": {
      "name": "Item 1",
      "value": 100
    }
  },
  {
    "json": {
      "name": "Item 2",
      "value": 200
    }
  }
]
----

==== Triggers (disparadores)

Los triggers son nodos especiales que inician la ejecuciÃ³n de un workflow.

**Tipos de triggers:**

**1. Manual Trigger**
* Se ejecuta manualmente desde la interfaz
* Ãštil para testing y desarrollo

**2. Webhook Trigger**
* Se ejecuta cuando recibe una peticiÃ³n HTTP
* Proporciona una URL Ãºnica
* Soporta GET, POST, PUT, DELETE

[source,text]
----
Diagrama Webhook:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      HTTP Request       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Cliente    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚  Webhook    â”‚
â”‚  (Frontend)  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  (n8n)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      HTTP Response       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                 â”‚
                                                 â–¼
                                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                          â”‚  Workflow   â”‚
                                          â”‚  Execution  â”‚
                                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
----

**3. Schedule Trigger (Cron)**
* Se ejecuta en intervalos de tiempo especÃ­ficos
* Usa expresiones cron
* Ejemplo: `0 9 * * *` (todos los dÃ­as a las 9 AM)

**4. Email Trigger**
* Se ejecuta cuando llega un email
* Monitorea una cuenta de email (IMAP)

**5. Form Trigger**
* Crea un formulario web
* Se ejecuta cuando se envÃ­a el formulario

**Ejemplo de trigger webhook:**
Ver archivo: `./ejemplos/n8n/02-webhook-trigger.json`

==== Acciones

Las acciones son nodos que realizan operaciones especÃ­ficas.

**CategorÃ­as principales:**

**1. ComunicaciÃ³n:**
* Email Send: Enviar emails
* Slack: Enviar mensajes a Slack
* Telegram: Enviar mensajes a Telegram
* Discord: Enviar mensajes a Discord

**2. Datos:**
* HTTP Request: Llamar a APIs
* Database: Operaciones CRUD en BD
* Google Sheets: Leer/escribir hojas
* File Operations: Leer/escribir archivos

**3. LÃ³gica:**
* IF: Condicionales
* Switch: MÃºltiples condiciones
* Merge: Combinar datos
* Split: Dividir items

**4. TransformaciÃ³n:**
* Set: Establecer valores
* Code: Ejecutar JavaScript/Python
* Function: Transformaciones simples
* Item Lists: Manipular arrays

**Diagrama de flujo con acciones:**
[source,text]
----
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Webhook â”‚â”€â”€â”€>â”‚   HTTP   â”‚â”€â”€â”€>â”‚   IF    â”‚â”€â”€â”€>â”‚  Email  â”‚
â”‚ Trigger â”‚    â”‚ Request  â”‚    â”‚         â”‚    â”‚  Send   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â–¼
                                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                â”‚  Slack  â”‚
                                â”‚  Send   â”‚
                                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
----

==== Datos y tipos de datos

**Estructura de datos en n8n:**

Todos los datos en n8n se pasan entre nodos como un array de **items**:

[source,json]
----
[
  {
    "json": { ... },        // Datos principales (JSON)
    "binary": { ... },      // Datos binarios (opcional)
    "pairedItem": { ... }   // Referencia al item origen
  }
]
----

**Tipos de datos soportados:**

**1. JSON (mÃ¡s comÃºn):**
[source,json]
----
{
  "json": {
    "id": 123,
    "name": "John Doe",
    "email": "john@example.com",
    "active": true,
    "tags": ["customer", "premium"],
    "metadata": {
      "created": "2025-01-15",
      "updated": "2025-01-15"
    }
  }
}
----

**2. Binary (archivos, imÃ¡genes):**
[source,json]
----
{
  "json": {
    "fileName": "document.pdf"
  },
  "binary": {
    "data": {
      "data": "base64_encoded_data...",
      "mimeType": "application/pdf",
      "fileName": "document.pdf",
      "fileSize": 1024000
    }
  }
}
----

**3. MÃºltiples items:**
[source,json]
----
[
  { "json": { "id": 1, "name": "Item 1" } },
  { "json": { "id": 2, "name": "Item 2" } },
  { "json": { "id": 3, "name": "Item 3" } }
]
----

**Acceso a datos:**

En expresiones, puedes acceder a datos usando:
* `$json`: Datos del item actual
* `$input`: Datos de entrada del nodo
* `$node`: Datos de un nodo especÃ­fico
* `$binary`: Datos binarios

**Ejemplos:**
[source,javascript]
----
// Acceder a un campo
{{ $json.email }}

// Acceder a campo anidado
{{ $json.user.address.city }}

// Acceder a array
{{ $json.items[0].name }}

// Datos de nodo anterior especÃ­fico
{{ $node["HTTP Request"].json.status }}
----

==== Expresiones y variables

Las expresiones permiten usar datos dinÃ¡micos en lugar de valores estÃ¡ticos.

**Sintaxis bÃ¡sica:**
[source,text]
----
Valor estÃ¡tico:
john@example.com

ExpresiÃ³n:
{{ $json.email }}
----

**Operadores:**

**AritmÃ©ticos:**
[source,javascript]
----
{{ $json.price * 1.21 }}           // MultiplicaciÃ³n
{{ $json.total - $json.discount }} // Resta
{{ $json.quantity + 10 }}          // Suma
{{ $json.price / 2 }}              // DivisiÃ³n
{{ $json.count % 10 }}             // MÃ³dulo
----

**ComparaciÃ³n:**
[source,javascript]
----
{{ $json.age > 18 }}               // Mayor que
{{ $json.status === 'active' }}    // Igual
{{ $json.count !== 0 }}            // Diferente
{{ $json.price >= 100 }}           // Mayor o igual
----

**LÃ³gicos:**
[source,javascript]
----
{{ $json.active && $json.verified }}   // AND
{{ $json.premium || $json.trial }}     // OR
{{ !$json.deleted }}                   // NOT
----

**Funciones integradas:**

**String:**
[source,javascript]
----
{{ $json.email.toLowerCase() }}
{{ $json.name.toUpperCase() }}
{{ $json.text.trim() }}
{{ $json.message.substring(0, 10) }}
{{ $json.name.split(' ')[0] }}
----

**Array:**
[source,javascript]
----
{{ $json.tags.length }}
{{ $json.items.join(', ') }}
{{ $json.numbers.filter(x => x > 10) }}
{{ $json.users.map(u => u.name) }}
----

**Date:**
[source,javascript]
----
{{ new Date().toISOString() }}
{{ new Date($json.createdAt).getFullYear() }}
{{ Date.now() }}
----

**Variables de entorno:**
[source,javascript]
----
{{ $env.API_KEY }}
{{ $env.DATABASE_URL }}
----

**Variables del workflow:**
[source,javascript]
----
{{ $execution.id }}                // ID de ejecuciÃ³n
{{ $execution.mode }}              // Modo (manual, trigger, etc.)
{{ $workflow.id }}                 // ID del workflow
{{ $workflow.name }}               // Nombre del workflow
{{ $now }}                         // Fecha/hora actual
{{ $today }}                       // Fecha actual (sin hora)
----

**Ejemplo completo:**
Ver archivo: `./ejemplos/n8n/03-expresiones-ejemplo.json`

**Expresiones complejas:**
[source,javascript]
----
// Condicional ternario
{{ $json.age >= 18 ? 'Adulto' : 'Menor' }}

// ConcatenaciÃ³n
{{ $json.firstName + ' ' + $json.lastName }}

// Template literals
{{ `Hola ${$json.name}, bienvenido!` }}

// CÃ¡lculo complejo
{{ ($json.subtotal * 1.21).toFixed(2) }}

// ValidaciÃ³n
{{ $json.email && $json.email.includes('@') ? $json.email : 'sin-email@ejemplo.com' }}
----

**Debugging de expresiones:**
[source,text]
----
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Expression Editor                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ {{ $json.price * 1.21 }}          â”‚
â”‚                                    â”‚
â”‚ Result Preview:                    â”‚
â”‚ 121.00                             â”‚
â”‚                                    â”‚
â”‚ Available Data:                    â”‚
â”‚ â€¢ $json.price = 100                â”‚
â”‚ â€¢ $json.currency = "EUR"           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
----

---

== MÃ“DULO 2: Primeros Pasos

=== 2.1 Crear tu Primer Workflow

==== IntroducciÃ³n a la creaciÃ³n de workflows

Crear un workflow en n8n es un proceso sencillo y directo. Todos los workflows comienzan en la pantalla principal de Workflows y se construyen mediante drag-and-drop de nodos.

==== Paso a paso: Crear un nuevo workflow

**Paso 1: Acceder a la pantalla de Workflows**

[source,text]
----
1. Abre http://localhost:5678 en tu navegador
2. Inicia sesiÃ³n con tus credenciales
3. Haz click en "Workflows" en el menÃº lateral izquierdo
----

**Paso 2: Crear un nuevo workflow**

[source,text]
----
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Workflows                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚  [+ New] [Import] [Search...]           â”‚
â”‚                                         â”‚
â”‚  Mi Primer Workflow  ğŸ“                 â”‚
â”‚  â”œâ”€ 5 executions â€¢ Last: 2 hours ago    â”‚
â”‚  â”œâ”€ Created: Jan 15, 2025               â”‚
â”‚                                         â”‚
â”‚  Mi Segundo Workflow ğŸ“                 â”‚
â”‚  â”œâ”€ 0 executions                        â”‚
â”‚  â””â”€ Created: Today                      â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Para crear uno nuevo:
â€¢ Haz click en el botÃ³n "+ New"
â€¢ O usa el atajo: Ctrl+Shift+N
----

**Paso 3: Configurar nombre y descripciÃ³n**

Una vez creas un nuevo workflow, verÃ¡s una ventana para configurar detalles bÃ¡sicos:

[source,text]
----
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Create New Workflow                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚ Workflow Name: *                        â”‚
â”‚ [Mi Primer Workflow              ]      â”‚
â”‚                                         â”‚
â”‚ Description:                            â”‚
â”‚ [Un workflow para enviar un         ]   â”‚
â”‚ [correo electrÃ³nico cada maÃ±ana    ]   â”‚
â”‚                                         â”‚
â”‚         [Cancel]  [Create]              â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

RECOMENDACIONES PARA NOMBRES:
âœ“ "Email Diario de Reportes"
âœ“ "Sincronizar Google Sheets con Airtable"
âœ“ "Procesar Pedidos desde Shopify"
âœ“ "Notificar Errores en Slack"

âœ— "workflow1"
âœ— "test"
âœ— "temp"
----

**Consejos para nombrar workflows:**

* **Descriptivos**: El nombre debe indicar quÃ© hace el workflow
* **Claros**: Evita abreviaturas que solo tÃº entiendas
* **Accionables**: Comienza con verbos (Enviar, Sincronizar, Procesar)
* **Ãšnicos**: No uses nombres duplicados

==== Guardar un workflow

**Guardado automÃ¡tico:**
n8n **guarda automÃ¡ticamente** tu trabajo cada vez que haces cambios:

[source,text]
----
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Workflow                         â”‚
â”‚                                 â”‚
â”‚ ğŸ’¾ Guardando...    (1-2 seg)     â”‚
â”‚ âœ“ Guardado        (cuando termina)
â”‚                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
----

**Guardado manual:**
TambiÃ©n puedes guardar manualmente:
* **Teclado**: Ctrl+S (Windows/Linux) o Cmd+S (Mac)
* **BotÃ³n**: Busca el icono de guardar en la interfaz

**InformaciÃ³n de guardado:**
[source,text]
----
En la esquina superior derecha verÃ¡s:

[Timestamp] â€¢ Ãšltima actualizaciÃ³n hace 2 minutos
[Usuario] â€¢ Por: admin@example.com
[Status] âœ“ Todos los cambios guardados
----

==== Versionamiento de workflows

n8n mantiene un historial de versiones de tus workflows. Puedes ver y restaurar versiones anteriores.

**Acceder al historial de versiones:**

[source,text]
----
1. Abre el workflow
2. Click en "Workflow" (esquina superior izquierda)
3. Selecciona "Show Versions"
4. VerÃ¡s todas las versiones anteriores:

VersiÃ³n  Fecha/Hora           Cambios
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
#5       Jan 15, 12:45 PM     AgreguÃ© nodo Email
#4       Jan 15, 11:20 AM     CambiÃ© condiciÃ³n IF
#3       Jan 14, 09:30 AM     Creado workflow
----

**Restaurar una versiÃ³n anterior:**

[source,text]
----
1. Abre el historial de versiones
2. Haz click en la versiÃ³n que quieres restaurar
3. Confirma la acciÃ³n
4. El workflow se restaurarÃ¡ a ese estado

âš ï¸ IMPORTANTE: Esto sobrescribirÃ¡ la versiÃ³n actual
Guarda una copia si necesitas mantener el cambio reciente
----

==== Copiar y duplicar workflows

A veces necesitas crear un workflow similar a uno existente. Puedes duplicarlo fÃ¡cilmente.

**Duplicar desde la lista de workflows:**

[source,text]
----
1. Ve a la lista de Workflows
2. Haz click derecho (o en los 3 puntos) en el workflow
3. Selecciona "Duplicate"
4. Se crearÃ¡ una copia con el nombre:
   "Mi Workflow Original - Copy"

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Actions Menu                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âš™ï¸  Edit                        â”‚
â”‚ ğŸ“‹ Duplicate                    â”‚
â”‚ ğŸ“¤ Export                       â”‚
â”‚ ğŸ—‘ï¸  Delete                     â”‚
â”‚ ğŸ“Š Statistics                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
----

**Ventajas de duplicar:**
* Crear versiones de un workflow para diferentes propÃ³sitos
* Testing y desarrollo sin afectar el original
* Crear templates basados en workflows existentes
* Ahorrar tiempo en workflows similares

==== Importar workflows

Puedes importar workflows desde archivos JSON (compartidos o descargados):

**Importar desde archivo:**

[source,text]
----
1. Abre la lista de Workflows
2. Click en el botÃ³n "Import"
3. Selecciona el archivo JSON
4. Revisa los nodos y configuraciones
5. Click en "Import"

âš ï¸ Nota: Si hay credenciales en el JSON:
   - TendrÃ¡s que configurarlas nuevamente por seguridad
   - n8n no almacena contraseÃ±as en los archivos JSON
----

**Estructura de un archivo JSON importable:**

El formato JSON de n8n tiene esta estructura:

[source,json]
----
{
  "name": "Mi Primer Workflow",
  "nodes": [
    {
      "name": "Start",
      "type": "n8n-nodes-base.manualTriggerNode",
      "typeVersion": 1,
      "position": [250, 300],
      "parameters": {}
    },
    {
      "name": "HTTP Request",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.4,
      "position": [450, 300],
      "parameters": {
        "method": "GET",
        "url": "https://api.example.com/data"
      }
    }
  ],
  "connections": {
    "Start": {
      "main": [[{"node": "HTTP Request", "branch": 0, "socket": 0}]]
    }
  }
}
----

==== Exportar workflows

Para compartir tus workflows o hacer backup:

**Exportar desde la lista:**

[source,text]
----
1. Ve a Workflows
2. Haz click derecho en el workflow
3. Selecciona "Export"
4. Se descargarÃ¡ un archivo JSON con el nombre del workflow

El archivo se guarda como: "NombreWorkflow.json"
----

**Exportar desde dentro del workflow:**

[source,text]
----
1. Abre el workflow
2. Click en "Workflow" (esquina superior)
3. Selecciona "Export"
4. Elige si deseas:
   - Export current workflow
   - Export with full data
5. DescargarÃ¡ el archivo JSON
----

**Casos de uso para exportar:**
* Compartir workflows con el equipo
* Hacer backup de workflows importantes
* Usar como templates para otros proyectos
* Documentar flujos de trabajo
* Control de versiones en Git

==== Buenas prÃ¡cticas para workflows

**Estructura recomendada:**

[source,text]
----
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. Trigger (Inicio del workflow)     â”‚
â”‚    â””â”€ Webhook, Schedule, Manual      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 2. Data Input (Entrada de datos)     â”‚
â”‚    â””â”€ HTTP Request, Base de datos    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 3. Processing (Procesamiento)        â”‚
â”‚    â””â”€ IF, Loop, Transform            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 4. Output (Salida de datos)          â”‚
â”‚    â””â”€ Email, Slack, Base de datos    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 5. Logging (Registro/DocumentaciÃ³n)  â”‚
â”‚    â””â”€ Guardar en archivo o DB        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
----

**DocumentaciÃ³n interna:**
Cada nodo tiene un campo "Notes" para agregar documentaciÃ³n:

[source,text]
----
Abre el nodo
â”œâ”€ Settings (pestaÃ±a)
â”‚  â””â”€ Notes (campo de texto)
â”‚     â””â”€ Escribe explicaciÃ³n del nodo
â”‚
Ejemplo:
"Este nodo valida que el email tenga
un formato correcto usando regex"
----

=== 2.2 Trabajar con Nodos BÃ¡sicos

==== IntroducciÃ³n a los nodos

Los nodos son los bloques de construcciÃ³n de n8n. Cada nodo realiza una tarea especÃ­fica y se conectan entre sÃ­ para crear un flujo de trabajo.

**AnatomÃ­a de un nodo en la interfaz:**

[source,text]
----
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âš¡ Manual Trigger               â”‚ â† Icono + Nombre
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  Input  â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â— Outputâ”‚
â”‚         (ConexiÃ³n entrada)  (ConexiÃ³n salida)
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

En el inspector (lado derecho):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Node Settings                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚ Parameters:                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Configuraciones especÃ­ficas...   â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                     â”‚
â”‚ Settings:                           â”‚
â”‚ â˜ Continue on Fail                 â”‚
â”‚ â˜ Retry on Fail                    â”‚
â”‚ â˜ Always Output Data               â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
----

==== Nodo: Manual Trigger

El **Manual Trigger** es el nodo mÃ¡s simple. Se usa para iniciar un workflow manualmente desde la interfaz.

**Casos de uso:**
* Testing y desarrollo
* Ejecuciones bajo demanda
* Flujos que no necesitan disparador automÃ¡tico

**ConfiguraciÃ³n:**

[source,text]
----
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Manual Trigger                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                 â”‚
â”‚ Este nodo NO tiene parÃ¡metros   â”‚
â”‚ Solo sirve como punto de inicio â”‚
â”‚                                 â”‚
â”‚ Para ejecutar:                  â”‚
â”‚ Click en [Execute Workflow]     â”‚
â”‚                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
----

**Diagrama visual:**

[source,text]
----
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Manual Trigger   â”‚
â”‚                  â”‚
â”‚  (Click aquÃ­     â”‚
â”‚   para ejecutar) â”‚
â”‚                  â”‚
â”‚        â—         â”‚ â† Output
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”‚ (Datos iniciales)
        â–¼
   Siguiente nodo
----

==== Nodo: HTTP Request

El **HTTP Request** es uno de los nodos mÃ¡s versÃ¡tiles. Permite llamar a cualquier API externa.

**ParÃ¡metros principales:**

[source,text]
----
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ HTTP Request                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                       â”‚
â”‚ Method: [GET â–¼]                       â”‚
â”‚         â”œâ”€ GET (Obtener datos)        â”‚
â”‚         â”œâ”€ POST (Enviar datos)        â”‚
â”‚         â”œâ”€ PUT (Actualizar)           â”‚
â”‚         â”œâ”€ PATCH (Actualizar parcial) â”‚
â”‚         â”œâ”€ DELETE (Eliminar)          â”‚
â”‚         â””â”€ HEAD                       â”‚
â”‚                                       â”‚
â”‚ URL:                                  â”‚
â”‚ [https://api.ejemplo.com/data      ]  â”‚
â”‚                                       â”‚
â”‚ Authentication: [None â–¼]              â”‚
â”‚                                       â”‚
â”‚ Query Parameters:                     â”‚
â”‚ [+ Add Parameter]                     â”‚
â”‚                                       â”‚
â”‚ Headers:                              â”‚
â”‚ [+ Add Header]                        â”‚
â”‚                                       â”‚
â”‚ Body Type: [JSON â–¼]                   â”‚
â”‚ Body:                                 â”‚
â”‚ [{"key": "value"}]                    â”‚
â”‚                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
----

**Ejemplo 1: Llamada GET simple**

[source,text]
----
ConfiguraciÃ³n:
â€¢ Method: GET
â€¢ URL: https://jsonplaceholder.typicode.com/posts/1
â€¢ Authentication: None

Resultado esperado:
{
  "userId": 1,
  "id": 1,
  "title": "sunt aut facere repellat...",
  "body": "quia et suscipit..."
}
----

**Ejemplo 2: Llamada POST con body**

[source,text]
----
ConfiguraciÃ³n:
â€¢ Method: POST
â€¢ URL: https://jsonplaceholder.typicode.com/posts
â€¢ Body Type: JSON (raw)
â€¢ Body:
{
  "userId": 1,
  "title": "Mi nuevo post",
  "body": "Este es el contenido"
}

Headers automÃ¡ticos:
â€¢ Content-Type: application/json
----

**Ejemplo 3: Usando expresiones dinÃ¡micas**

[source,text]
----
Tienes un workflow que recibe datos de un webhook:

Webhook Output:
{
  "email": "john@example.com",
  "name": "John Doe"
}

En HTTP Request puedes usar:
â€¢ URL: https://api.example.com/users/{{ $json.email }}
â€¢ Body:
{
  "name": "{{ $json.name }}",
  "timestamp": "{{ $now }}"
}

Resultado en ejecuciÃ³n:
â€¢ URL: https://api.example.com/users/john@example.com
â€¢ Body:
{
  "name": "John Doe",
  "timestamp": "2025-01-15T10:30:00Z"
}
----

**Respuesta HTTP:**

[source,text]
----
n8n captura automÃ¡ticamente:

{
  "json": {
    // Cuerpo de la respuesta (JSON)
    "status": "success",
    "data": {...}
  },
  "headers": {
    // Headers de la respuesta
    "content-type": "application/json",
    "content-length": "1234"
  },
  "statusCode": 200,
  "statusMessage": "OK"
}

En siguiente nodo accedes con:
{{ $json.json.status }}
{{ $json.statusCode }}
{{ $json.headers['content-type'] }}
----

==== Nodo: Set

El nodo **Set** se usa para establecer o transformar datos de forma simple.

**Casos de uso:**
* Crear nuevos campos
* Renombrar campos
* Establecer valores por defecto
* Transformar tipos de datos

**Ejemplo 1: Agregar nuevos campos**

Entrada:
[source,json]
----
{
  "name": "John",
  "email": "john@example.com"
}
----

ConfiguraciÃ³n del nodo Set:
[source,text]
----
Assign:
Key              | Type | Value
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
name             | json | = John (del input)
email            | json | = john@... (del input)
id               | num  | 12345
timestamp        | str  | = {{ $now }}
status           | str  | active
----

Salida:
[source,json]
----
{
  "name": "John",
  "email": "john@example.com",
  "id": 12345,
  "timestamp": "2025-01-15T10:30:00.000Z",
  "status": "active"
}
----

**Ejemplo 2: Transformar datos**

[source,text]
----
Entrada: { "email": "JOHN@EXAMPLE.COM" }

ConfiguraciÃ³n Set:
Key      | Type | Value
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
email    | str  | = {{ $json.email.toLowerCase() }}
domain   | str  | = {{ $json.email.split('@')[1] }}

Salida:
{
  "email": "john@example.com",
  "domain": "example.com"
}
----

==== Nodo: Function

El **Function** node es similar a Set pero soporta JavaScript.

**Ejemplo con Function:**

[source,javascript]
----
// Entrada
items.forEach((item) => {
  item.json.fullName = `${item.json.firstName} ${item.json.lastName}`;
  item.json.email = item.json.email.toLowerCase();
  item.json.age = new Date().getFullYear() - item.json.birthYear;
  return item;
});

return items;
----

==== Conectar nodos

**CÃ³mo conectar dos nodos:**

[source,text]
----
1. Abre el workflow
2. Selecciona el primer nodo
3. Busca el punto de conexiÃ³n (â—) en la derecha
4. Arrastra desde ese punto hasta el siguiente nodo
5. Se crearÃ¡ una lÃ­nea de conexiÃ³n

Visual:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Node 1   â”‚
â”‚          â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
                      â–¼
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚ Node 2   â”‚
                â”‚          â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
----

**MÃºltiples conexiones (IF):**

[source,text]
----
Si tienes un nodo IF que produce dos outputs:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   IF     â”‚
â”‚          â”œâ”€trueâ”€â”€â”€â”€â”€â”€â”
â”‚          â”‚           â”‚
â”‚          â”œâ”€falseâ”€â”   â”‚
â”‚          â”‚       â”‚   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â–¼   â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ Node A (true)  â”‚
            â”‚ Node B (false) â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
----

**Desconectar nodos:**

[source,text]
----
â€¢ Selecciona la conexiÃ³n (la lÃ­nea se pondrÃ¡ azul)
â€¢ Presiona Delete o haz click en el icono de borrar
â€¢ La conexiÃ³n se eliminarÃ¡

âš ï¸ Nota: Los nodos seguirÃ¡n existiendo
       Solo se elimina la conexiÃ³n entre ellos
----

==== Ejecutar un workflow

**Ejecutar manualmente:**

[source,text]
----
1. AsegÃºrate de que el workflow tenga al menos:
   â€¢ Un trigger (Manual, Webhook, Schedule, etc.)
   â€¢ Un nodo adicional (opcional)

2. Click en el botÃ³n [Execute Workflow]
   UbicaciÃ³n: Generalmente en la parte superior o lado derecho

3. VerÃ¡s la ejecuciÃ³n en tiempo real:
   - Los nodos se iluminarÃ¡n cuando se ejecuten
   - Se mostrarÃ¡n los datos en el inspector

4. Ver resultados:
   - Panel derecho: Muestra salida de cada nodo
   - JSON view: Ver datos en formato JSON
   - Table view: Ver datos en tabla
----

**Resultado de ejecuciÃ³n:**

[source,text]
----
EjecuciÃ³n exitosa:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ“ Success                     â”‚
â”‚ Execution time: 2.3 seconds   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Manual Trigger (Item 1)       â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”‚ {}                          â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚           â–¼                   â”‚
â”‚ HTTP Request (Item 1)         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”‚ {                           â”‚
â”‚ â”‚   "status": 200,            â”‚
â”‚ â”‚   "data": {...}             â”‚
â”‚ â”‚ }                           â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

EjecuciÃ³n fallida:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ— Error                       â”‚
â”‚ Execution time: 1.2 seconds   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ HTTP Request                  â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”‚ Error: Connection timeout   â”‚
â”‚ â”‚ Code: ETIMEDOUT             â”‚
â”‚ â”‚ URL: https://api.down...    â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
----

**Debugging durante la ejecuciÃ³n:**

[source,text]
----
1. Click en un nodo durante/despuÃ©s ejecuciÃ³n
2. El inspector mostrarÃ¡:
   - Datos de entrada
   - ConfiguraciÃ³n del nodo
   - Datos de salida
   - Tiempo de ejecuciÃ³n

3. Haz click en cada pestaÃ±a:
   â”œâ”€ Data: Datos procesados
   â”œâ”€ Settings: ConfiguraciÃ³n del nodo
   â”œâ”€ Info: InformaciÃ³n del nodo
   â””â”€ Details: Detalles tÃ©cnicos
----

=== 2.3 Triggers BÃ¡sicos

==== IntroducciÃ³n a triggers

Los triggers son **especiales**: sin ellos, el workflow no se ejecuta automÃ¡ticamente. Pueden ser:
* **Manuales**: EjecuciÃ³n manual desde la interfaz
* **AutomÃ¡ticos**: Se ejecutan por eventos (horario, webhook, email, etc.)

**Diagrama de trigger:**

[source,text]
----
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TRIGGER (Punto de inicio)            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                      â”‚
â”‚  Evento externo                      â”‚
â”‚  â””â”€> Webhook request                 â”‚
â”‚  â””â”€> Scheduled time                  â”‚
â”‚  â””â”€> Email received                  â”‚
â”‚  â””â”€> Manual click                    â”‚
â”‚                                      â”‚
â”‚           â”‚                          â”‚
â”‚           â–¼                          â”‚
â”‚       Ejecutar workflow              â”‚
â”‚           â”‚                          â”‚
â”‚           â–¼                          â”‚
â”‚  Siguiente nodo...                   â”‚
â”‚                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
----

==== Trigger: Manual

Ya lo cubrimos en la secciÃ³n anterior. Es el mÃ¡s simple:

[source,text]
----
CaracterÃ­sticas:
âœ“ Sin configuraciÃ³n necesaria
âœ“ Ideal para testing
âœ“ Ãštil para ejecuciones bajo demanda
âœ“ Perfecto para aprender

Desventajas:
âœ— No es automÃ¡tico
âœ— Requiere intervenciÃ³n manual
âœ— No es prÃ¡ctico para producciÃ³n
----

==== Trigger: HTTP (Webhook)

El **HTTP Trigger** (Webhook) crea una URL Ãºnica que inicia el workflow cuando recibe una peticiÃ³n HTTP.

**CÃ³mo crear un Webhook Trigger:**

[source,text]
----
1. Abre/crea un workflow
2. Click en [+ Add Node]
3. Busca "Webhook" o "HTTP"
4. Selecciona "Webhook"
5. VerÃ¡s una URL Ãºnica generada

Ejemplo de URL:
https://n8n.example.com/webhook/abc123def456ghi789

Esta URL es:
âœ“ Ãšnica por workflow
âœ“ PÃºblica (accesible desde cualquier lugar)
âœ“ Segura si usas HTTPS
âœ“ Personalizable
----

**ConfiguraciÃ³n del Webhook:**

[source,text]
----
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Webhook Node Settings                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                      â”‚
â”‚ Path (Ruta personalizada):           â”‚
â”‚ [webhook                          ]  â”‚
â”‚                                      â”‚
â”‚ HTTP Method:                         â”‚
â”‚ â˜‘ GET    â˜‘ POST    â˜‘ PUT    â˜‘ DELETEâ”‚
â”‚ â˜‘ HEAD   â˜‘ PATCH   â˜‘ OPTIONS        â”‚
â”‚                                      â”‚
â”‚ Response:                            â”‚
â”‚ â—‹ First Item Only                   â”‚
â”‚ â—‹ Last Item Only                    â”‚
â”‚ â—‰ All Items                         â”‚
â”‚ â—‹ Custom                            â”‚
â”‚                                      â”‚
â”‚ Webhook URL:                         â”‚
â”‚ https://n8n.example.com/webhook/...  â”‚
â”‚ [Copy to Clipboard]                 â”‚
â”‚                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
----

**Ejemplo: Webhook para recibir pedidos**

[source,bash]
----
URL del Webhook:
https://n8n.example.com/webhook/orders

Un cliente envÃ­a un pedido:
curl -X POST https://n8n.example.com/webhook/orders \
  -H "Content-Type: application/json" \
  -d '{
    "orderId": "ORD-12345",
    "customer": "John Doe",
    "amount": 99.99,
    "items": ["item1", "item2"]
  }'

El workflow recibe estos datos automÃ¡ticamente
y el nodo Webhook output serÃ¡:
{
  "orderId": "ORD-12345",
  "customer": "John Doe",
  "amount": 99.99,
  "items": ["item1", "item2"]
}
----

**Diagrama de flujo Webhook:**

[source,text]
----
Cliente/AplicaciÃ³n
        â”‚
        â”‚ HTTP Request (POST/GET/etc)
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Webhook URL      â”‚
â”‚ /webhook/orders  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”‚ Datos recibidos
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Webhook Node     â”‚
â”‚ (n8n)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”‚ Inicia ejecuciÃ³n
        â–¼
   Siguiente nodo
   (Procesar datos)
        â”‚
        â–¼
   Guardar o enviar
   informaciÃ³n
----

==== Trigger: Schedule (Cron)

El **Schedule Trigger** ejecuta el workflow en intervalos regulares segÃºn una expresiÃ³n cron.

**Expresiones Cron bÃ¡sicas:**

[source,text]
----
Formato:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Minuto   â”‚ Hora     â”‚ DÃ­a      â”‚ Mes      â”‚ DÃ­a Sem. â”‚
â”‚ (0-59)   â”‚ (0-23)   â”‚ (1-31)   â”‚ (1-12)   â”‚ (0-6)    â”‚
â”‚ *        â”‚ *        â”‚ *        â”‚ *        â”‚ *        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   30     â”‚   9      â”‚   *      â”‚   *      â”‚   *      â”‚
â”‚ (Minuto) â”‚ (Hora)   â”‚ (Todos)  â”‚ (Todos)  â”‚ (Todos)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Ejemplos comunes:

"0 9 * * *"
= Todos los dÃ­as a las 9:00 AM
= Minuto 0, Hora 9

"*/15 * * * *"
= Cada 15 minutos
= * = todos, /15 = cada 15

"0 0 * * 0"
= Todos los domingos a las 00:00
= DÃ­a de semana 0 = domingo

"0 9-17 * * 1-5"
= De lunes a viernes, cada hora 9-17 (9 AM a 5 PM)

"0 0 1 * *"
= El primer dÃ­a de cada mes a las 00:00

"30 23 * * *"
= Todos los dÃ­as a las 23:30 (11:30 PM)

"0 */6 * * *"
= Cada 6 horas (00:00, 06:00, 12:00, 18:00)
----

**Herramienta de generador Cron:**

https://crontab.guru/ es una excelente herramienta para generar y validar expresiones cron.

**ConfiguraciÃ³n en n8n:**

[source,text]
----
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Schedule Trigger                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                  â”‚
â”‚ Trigger Type:                    â”‚
â”‚ â—‰ Cron                          â”‚
â”‚ â—‹ Simple interval                â”‚
â”‚ â—‹ Every custom interval          â”‚
â”‚                                  â”‚
â”‚ Cron Expression:                 â”‚
â”‚ [0 9 * * * ]                    â”‚
â”‚  â†‘ = Cada dÃ­a a las 9:00 AM     â”‚
â”‚                                  â”‚
â”‚ Time Zone:                       â”‚
â”‚ [Europe/Madrid           â–¼]      â”‚
â”‚                                  â”‚
â”‚ [Copy Cron]                      â”‚
â”‚ [Cron Guru Link] ğŸ”—              â”‚
â”‚                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
----

**Ejemplo: Reporte diario**

Configurar un workflow que envÃ­e un reporte todos los dÃ­as a las 9 AM:

[source,text]
----
Trigger: Schedule
â”œâ”€ Type: Cron
â”œâ”€ Expression: 0 9 * * *
â””â”€ Time Zone: Europe/Madrid

Workflow:
Schedule â†’ Query Database â†’ Generate Report â†’ Send Email

Resultado:
Cada dÃ­a a las 9:00 AM:
1. Se ejecuta automÃ¡ticamente
2. Obtiene datos de BD
3. Genera reporte
4. EnvÃ­a por email
----

==== Trigger: Email

El **Email Trigger** monitorea una cuenta de email y ejecuta el workflow cuando llega un nuevo email.

**ConfiguraciÃ³n:**

[source,text]
----
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Email Trigger                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                              â”‚
â”‚ Mailbox:                     â”‚
â”‚ [admin@example.com      â–¼]   â”‚
â”‚                              â”‚
â”‚ Conditions:                  â”‚
â”‚ Search Query: (opcional)     â”‚
â”‚ [                         ]  â”‚
â”‚ Ej: "subject:invoice"        â”‚
â”‚                              â”‚
â”‚ Attachment Download:         â”‚
â”‚ â˜‘ Download attachments       â”‚
â”‚                              â”‚
â”‚ Include Headers:             â”‚
â”‚ â˜‘ Include email headers      â”‚
â”‚                              â”‚
â”‚ Metadata:                    â”‚
â”‚ â˜‘ Include email metadata     â”‚
â”‚                              â”‚
â”‚ Simple Interval:             â”‚
â”‚ Check every: [5] minutes     â”‚
â”‚                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
----

**Datos disponibles:**

[source,json]
----
Cuando llega un email, n8n captura:
{
  "from": "cliente@example.com",
  "to": "admin@example.com",
  "subject": "Nuevo pedido #123",
  "body": "El cuerpo del email...",
  "text": "VersiÃ³n texto plano...",
  "html": "VersiÃ³n HTML...",
  "id": "email-id-12345",
  "uid": "unique-identifier",
  "attachments": [
    {
      "filename": "invoice.pdf",
      "content": "base64_encoded_data",
      "mimeType": "application/pdf"
    }
  ],
  "headers": { ... },
  "date": "2025-01-15T10:30:00.000Z"
}
----

**Caso de uso: Procesar facturas recibidas por email**

[source,text]
----
Email Trigger
â”œâ”€ Monitorea: facturas@example.com
â”œâ”€ Search: "subject:factura"
â”œâ”€ Download attachments: âœ“
â”‚
â””â”€â”€> Extraer datos del email
     â”œâ”€ De: remitente
     â”œâ”€ Asunto: factura
     â””â”€ Adjunto: PDF/Excel

    â”‚
    â””â”€â”€> Extraer texto del PDF

    â”‚
    â””â”€â”€> Guardar en base de datos

    â”‚
    â””â”€â”€> Enviar confirmaciÃ³n
----

==== Trigger: Interval (Intervalo simple)

Una forma simplificada de Schedule para principiantes.

**Vs Cron:**
- **Interval**: MÃ¡s fÃ¡cil, intervalos simples (cada X minutos/horas/dÃ­as)
- **Cron**: MÃ¡s potente, horarios especÃ­ficos complejos

**ConfiguraciÃ³n:**

[source,text]
----
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Simple Interval Trigger      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                              â”‚
â”‚ Interval:                    â”‚
â”‚ [5 ] [minutes  â–¼]            â”‚
â”‚                              â”‚
â”‚ Opciones:                    â”‚
â”‚ â”œâ”€ seconds (segundos)        â”‚
â”‚ â”œâ”€ minutes (minutos)         â”‚
â”‚ â”œâ”€ hours (horas)             â”‚
â”‚ â””â”€ days (dÃ­as)               â”‚
â”‚                              â”‚
â”‚ Resultado:                   â”‚
â”‚ "Cada 5 minutos"             â”‚
â”‚                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
----

**Ejemplos:**
* 5 minutes = Cada 5 minutos
* 1 hour = Cada hora
* 3 days = Cada 3 dÃ­as

==== Consideraciones de TimeZone

**Â¿Por quÃ© es importante?**

Si tu schedule es "9 AM", Â¿quÃ© timezone?
- Madrid: 9:00 AM (UTC+1)
- Nueva York: 9:00 AM (UTC-5)
- Tokio: 9:00 AM (UTC+9)

Son **diferentes horarios reales**.

**Configurar TimeZone:**

[source,text]
----
1. Abre Schedule Trigger
2. Busca campo "Time Zone"
3. Selecciona tu zona horaria

Zonas comunes:
â”œâ”€ Europe/Madrid
â”œâ”€ Europe/London
â”œâ”€ America/New_York
â”œâ”€ America/Los_Angeles
â”œâ”€ Asia/Tokyo
â”œâ”€ Australia/Sydney
â”œâ”€ etc.

RecomendaciÃ³n:
Usa la zona horaria de tu empresa/clientes
----

=== 2.4 Mi Primer Workflow PrÃ¡ctico

==== Proyecto: Sistema de NotificaciÃ³n por Slack

Vamos a crear un workflow prÃ¡ctico que:
1. Recibe una solicitud por webhook
2. Procesa los datos
3. EnvÃ­a una notificaciÃ³n a Slack

**Requisitos previos:**

- n8n instalado y corriendo
- Acceso a un workspace de Slack (o crear uno gratis)
- Token de Slack (bot token)

**Paso 1: Crear el workflow**

Crea un nuevo workflow llamado: "NotificaciÃ³n Slack"

**Paso 2: Agregar Webhook Trigger**

[source,text]
----
1. Click en "Add Node"
2. Busca "Webhook"
3. Selecciona "Webhook"
4. Copia la URL del webhook (la necesitarÃ¡s para testing)

ConfiguraciÃ³n:
â”œâ”€ HTTP Method: POST
â”œâ”€ Response: All items
â””â”€ URL: https://[tu-n8n]/webhook/slack-notification
----

**Paso 3: Agregar nodo HTTP Request para Slack**

[source,text]
----
1. Conecta un nodo HTTP Request al Webhook
2. ConfiguraciÃ³n:

Method: POST
URL: https://hooks.slack.com/services/[TU_WEBHOOK_URL]

Body:
{
  "text": "Nueva notificaciÃ³n",
  "blocks": [
    {
      "type": "section",
      "text": {
        "type": "mrkdwn",
        "text": "*Nuevo mensaje*\n{{ $json.message }}"
      }
    }
  ]
}
----

**Paso 4: Testing**

Enviar datos al webhook:

[source,bash]
----
curl -X POST https://[tu-n8n]/webhook/slack-notification \
  -H "Content-Type: application/json" \
  -d '{
    "message": "Hola desde n8n!"
  }'
----

**JSON Importable (Ejemplo completo):**

Este archivo se puede importar directamente en n8n.

Ver archivo: `./ejemplos/n8n/01-webhook-slack-notification.json`

[source,json]
----
{
  "name": "NotificaciÃ³n Slack",
  "nodes": [
    {
      "name": "Webhook",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 1,
      "position": [250, 300],
      "webhookId": "webhook123",
      "parameters": {
        "path": "slack-notification",
        "httpMethod": "POST"
      }
    },
    {
      "name": "HTTP Request - Slack",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.4,
      "position": [450, 300],
      "parameters": {
        "url": "https://hooks.slack.com/services/YOUR/WEBHOOK/URL",
        "method": "POST",
        "jsonBody": true,
        "body": {
          "text": "Nueva notificaciÃ³n",
          "blocks": [
            {
              "type": "section",
              "text": {
                "type": "mrkdwn",
                "text": "*Mensaje:*\n{{ $json.message }}"
              }
            }
          ]
        }
      }
    }
  ],
  "connections": {
    "Webhook": {
      "main": [[{"node": "HTTP Request - Slack", "branch": 0, "socket": 0}]]
    }
  }
}
----

**Proyecto 2: Procesar Datos de Formulario**

Este workflow:
1. Recibe datos de un formulario
2. Valida los datos
3. Guarda en una hoja de cÃ¡lculo

[source,text]
----
Webhook (formulario)
    â”‚
    â–¼
IF (validar email)
    â”‚
    â”œâ”€ True â†’ Google Sheets (guardar)
    â”‚         â”‚
    â”‚         â–¼
    â”‚         Email (confirmaciÃ³n)
    â”‚
    â””â”€ False â†’ Email (error)

JSON importable:
Ver: ./ejemplos/n8n/02-form-processor.json
----

**Proyecto 3: Llamada a API y Procesamiento**

[source,text]
----
Nombre: "Obtener datos de clima"

Trigger: Schedule (cada 6 horas)
    â”‚
    â–¼
HTTP Request (OpenWeatherAPI)
    â”‚
    â–¼
Set (transformar datos)
    â”‚
    â–¼
Slack (enviar notificaciÃ³n)

Datos:
- Obtiene clima de una ciudad
- Extrae temperatura, humedad, condiciones
- EnvÃ­a resumen a Slack

JSON importable:
Ver: ./ejemplos/n8n/03-weather-api.json
----

==== Repositorio de Ejemplos

Todos los archivos JSON estÃ¡n disponibles en:
`./ejemplos/n8n/`

Para importar uno:
1. Click en "Workflows"
2. Click en "Import"
3. Selecciona el archivo JSON
4. Click en "Import"

**Archivos disponibles:**

[cols="1,2", options="header"]
|===
|Archivo|DescripciÃ³n

|01-webhook-slack-notification.json
|Webhook â†’ Slack (nivel bÃ¡sico)

|02-form-processor.json
|Formulario con validaciÃ³n â†’ Google Sheets

|03-weather-api.json
|API externa â†’ TransformaciÃ³n â†’ NotificaciÃ³n

|04-database-sync.json
|Base de datos â†’ SincronizaciÃ³n â†’ Backup

|05-email-daily-report.json
|Schedule â†’ Query BD â†’ Email con reporteaudit
|===

==== PrÃ³ximos pasos

Ahora que conoces los conceptos bÃ¡sicos:

1. **Practica con los ejemplos**
   - Importa cada archivo JSON
   - Modifica los parÃ¡metros
   - Ajusta a tus necesidades

2. **Crea tus propios workflows**
   - Empieza simple (webhook â†’ slack)
   - Agrega paso a paso mÃ¡s nodos
   - Prueba diferentes triggers

3. **Explora la documentaciÃ³n**
   - Lee sobre nodos especÃ­ficos que necesites
   - Mira ejemplos en la comunidad
   - Ãšnete al Discord de n8n

4. **Experimenta con APIs**
   - Prueba APIs pÃºblicas (JSONPlaceholder, OpenWeather)
   - Aprende a manejar errores
   - Domina las expresiones dinÃ¡micas

---

== MÃ“DULO 3: Nodos y Conectores

Los nodos son los bloques bÃ¡sicos de construcciÃ³n en n8n, similares a LEGO: cada pieza tiene un propÃ³sito especÃ­fico y se conectan entre sÃ­ para crear flujos complejos. En este mÃ³dulo aprenderÃ¡s todos los tipos de nodos disponibles y cÃ³mo utilizarlos.

=== 3.1 Tipos de Nodos

==== Â¿QuÃ© es un Nodo?

Un **nodo** es una unidad de trabajo que realiza una acciÃ³n especÃ­fica:
- Recibe datos de entrada (de otros nodos o del usuario)
- Procesa esos datos segÃºn su configuraciÃ³n
- Emite datos de salida hacia otros nodos

La belleza de n8n estÃ¡ en que puedes conectar nodos sin escribir cÃ³digo (aunque tambiÃ©n puedes hacerlo si lo necesitas).

==== 3.1.1 Nodos de Entrada (Triggers)

Los **triggers** son nodos que inician un workflow. Sin un trigger, el workflow nunca se ejecuta.

[cols="1,2,1", options="header"]
|===
|Tipo|DescripciÃ³n|Ejemplo

|**Webhook**
|Escucha HTTP requests en una URL Ãºnica
|Formulario web â†’ n8n

|**Schedule**
|Ejecuta en horarios especÃ­ficos (cron)
|Cada dÃ­a a las 9 AM

|**Manual**
|Se ejecuta al hacer clic en "Execute Workflow"
|Desarrollo y testing

|**File**
|Se activa cuando se sube un archivo
|Procesamiento de documentos

|**Email**
|Se activa cuando llega un email
|Procesamiento de mensajes

|**Database**
|Polling: verifica BD regularmente
|SincronizaciÃ³n de datos
|===

**AnalogÃ­a:** Si un workflow fuese una pelÃ­cula, los triggers serÃ­an el evento que hace que empiece (ej: "cuando el usuario presiona un botÃ³n").

**Ejemplo prÃ¡ctico - Webhook:**
[source,text]
----
1. Crear webhook en n8n
2. n8n genera URL: https://hook.n8n.io/webhook/abc123
3. Configurar formulario web para enviar datos a esa URL
4. Cuando alguien envÃ­a el formulario â†’ webhook dispara el workflow
----

==== 3.1.2 Nodos de AcciÃ³n (Actions)

Los **nodos de acciÃ³n** realizan tareas especÃ­ficas: enviar emails, crear tickets, guardar datos, etc.

[cols="1,2,2", options="header"]
|===
|CategorÃ­a|Nodos|Casos de Uso

|**ComunicaciÃ³n**
|Slack, Email, Discord, Telegram, Teams
|Notificaciones, alertas

|**Datos**
|Google Sheets, HTTP Request, Database
|Lectura/escritura de informaciÃ³n

|**CRM/Business**
|Salesforce, HubSpot, Pipedrive
|GestiÃ³n de clientes

|**E-commerce**
|Shopify, WooCommerce, Stripe
|Procesamiento de pedidos

|**Social**
|Twitter, Instagram, LinkedIn
|Publicar y monitorear redes
|===

**Ejemplo:** Un nodo de **Email** puede:
- Enviar emails simples
- Usar templates con variables dinÃ¡micas
- Adjuntar archivos
- Enviar en lotes

==== 3.1.3 Nodos de Flujo de Control (Flow Control)

Estos nodos **controlan la lÃ³gica** de tu workflow: tomar decisiones, repetir acciones, combinar datos.

[cols="1,2,3", options="header"]
|===
|Nodo|FunciÃ³n|Ejemplo

|**IF**
|Ejecuta cÃ³digo si condiciÃ³n es verdadera
|Si precio > 1000 â†’ notificar gerente

|**Switch**
|Elige uno de N caminos segÃºn valor
|Si estado = "premium" â†’ camino A, si "bÃ¡sico" â†’ camino B

|**Loop**
|Repite un conjunto de nodos
|Procesar cada item en un array

|**Merge**
|Combina datos de mÃºltiples ramas
|Juntar resultados de 2 bÃºsquedas

|**Aggregate**
|Agrupa datos de mÃºltiples ejecuciones
|Recopilar logs antes de enviar
|===

**Ejemplo visual - IF Statement:**
[source,text]
----
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Webhook Input  â”‚
â”‚  (monto: 500)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
    â”‚    IF    â”‚
    â”‚monto>1000â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”˜
         â”‚    â”‚
        YES  NO
         â”‚    â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â” â”Œâ”€â–¼â”€â”€â”€â”€â”
    â”‚Slack â”‚ â”‚Email â”‚
    â”‚Alert â”‚ â”‚Ticketâ”‚
    â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜
----

==== 3.1.4 Nodos de TransformaciÃ³n

Los nodos de transformaciÃ³n **modifican datos** sin llamar a servicios externos.

[cols="1,2,3", options="header"]
|===
|Nodo|FunciÃ³n|Casos de Uso

|**Set**
|Asigna valores a campos
|Crear estructura de datos

|**Function**
|Ejecuta expresiones n8n
|Operaciones simples sin cÃ³digo

|**Code (JS/Python)**
|Escribe lÃ³gica personalizada
|Transformaciones complejas

|**Merge**
|Combina objetos/arrays
|Consolidar datos

|**Split/Batch**
|Divide datos en mÃºltiples items
|Procesar en lotes
|===

**Ejemplo - Set Node:**
```
Entrada: { nombre: "Juan", apellido: "PÃ©rez" }
ConfiguraciÃ³n Set: fullName = nombre + " " + apellido
Salida: { nombre: "Juan", apellido: "PÃ©rez", fullName: "Juan PÃ©rez" }
```

==== 3.1.5 Nodos de Salida (Output)

Aunque cualquier nodo puede ser final, estos estÃ¡n optimizados para devolver datos al usuario o sistema externo.

[cols="1,2", options="header"]
|===
|Nodo|Uso

|**Webhook Response**
|Devuelve datos HTTP al llamador

|**HTTP Request** (GET)
|Puede devolver respuestas

|**Database** (SELECT)
|Retorna resultados de queries
|===

=== 3.2 Nodos de ComunicaciÃ³n

Los nodos de comunicaciÃ³n permiten **notificar a usuarios o sistemas**. Son esenciales para automatizaciones prÃ¡cticas.

==== 3.2.1 Email Node

El nodo mÃ¡s versÃ¡til para comunicaciÃ³n asÃ­ncrona.

**CaracterÃ­sticas principales:**

1. **EnvÃ­o simple:**
   - To, Cc, Bcc
   - Subject dinÃ¡mico (usando expresiones)
   - Texto plano o HTML

2. **Emails avanzados:**
   - Templates con variables
   - Attachments (adjuntos)
   - Headers personalizados
   - Retry automÃ¡tico

**Ejemplo de workflow:**
[source,text]
----
Webhook (recibe nuevo cliente)
    â†“
[Usar nombre y email de cliente]
    â†“
Email Node
  - To: cliente@email.com
  - Subject: "Bienvenido {{name}}!"
  - Body: "Hola {{name}}, tu cÃ³digo es {{code}}"
    â†“
Database (guardar envÃ­o)
----

==== 3.2.2 Slack Node

Para notificaciones en tiempo real dentro de Slack.

**Capacidades:**
- Enviar mensajes a canales
- Mencionar usuarios (@user)
- Threads (conversaciones encadenadas)
- Rich formatting (negrita, cÃ³digo, listas)
- Reacciones emoji
- Botones interactivos

**Ejemplo:**
```
mensaje = "ğŸ“Š Nuevo pedido de ${{amount}}\nCliente: {{customer}}\nEstado: {{status}}"
canal = "#ventas"
â†’ Slack muestra mensaje formateado en tiempo real
```

==== 3.2.3 Discord, Telegram, Teams

Similares a Slack pero para diferentes plataformas:

- **Discord:** Comunidades, gaming, comunidad tech
- **Telegram:** Chats privados, bots livianos
- **Microsoft Teams:** Entornos corporativos, integraciÃ³n Office 365

**Ventaja key:** Usar el que tu equipo ya utiliza para mÃ¡xima adopciÃ³n.

=== 3.3 Nodos de Datos

Para leer y escribir informaciÃ³n desde/hacia diferentes fuentes.

==== 3.3.1 HTTP Request Node

El "suiza" de n8n: funciona con cualquier API que siga estÃ¡ndares REST.

**ConfiguraciÃ³n:**
- **URL:** Endpoint de la API
- **Method:** GET, POST, PUT, DELETE, PATCH
- **Headers:** Authentication, Content-Type
- **Body:** Datos a enviar (JSON, form-data, raw)
- **Params:** Query parameters

**Ejemplo - Obtener datos de JSONPlaceholder:**
[source,text]
----
URL: https://jsonplaceholder.typicode.com/posts/1
Method: GET
Response:
{
  "userId": 1,
  "id": 1,
  "title": "...",
  "body": "..."
}
----

==== 3.3.2 Database Nodes

Conectar directamente a bases de datos: MySQL, PostgreSQL, MongoDB, SQLite.

**Operaciones comunes:**

[cols="1,2,2", options="header"]
|===
|OperaciÃ³n|SQL|Uso

|**Read**
|SELECT * FROM users WHERE id = 1
|Obtener datos

|**Create**
|INSERT INTO users VALUES (...)
|Insertar registros

|**Update**
|UPDATE users SET name = 'Juan' WHERE id = 1
|Modificar datos

|**Delete**
|DELETE FROM users WHERE id = 1
|Eliminar registros
|===

==== 3.3.3 Google Sheets Node

IntegraciÃ³n nativa con Google Sheets, ideal para workflows menos tÃ©cnicos.

**Capacidades:**
- Leer filas
- Agregar filas
- Actualizar filas
- Crear spreadsheets
- Trabajar con mÃºltiples sheets

**Caso de uso comÃºn:**
```
Webhook (datos de formulario) â†’ Set (organizar) â†’ Google Sheets (append row) â†’ Email (confirmaciÃ³n)
```

==== 3.3.4 Otros Nodos de Datos

- **Airtable:** Base de datos visual, similar a Sheets pero mÃ¡s potente
- **Notion:** DocumentaciÃ³n y bases de datos colaborativas
- **Supabase:** PostgreSQL con interfaz visual
- **CSV:** Leer/escribir archivos CSV
- **JSON:** Manipular archivos JSON

=== 3.4 Nodos de LÃ³gica

==== 3.4.1 IF Node

**Condicionales simples:** Si X es verdad, ejecuta rama A. Si falso, rama B.

**Sintaxis:**
```
Condition: {{$node.previousNode.data.price}} > 1000
True branch: [Slack notification]
False branch: [Log in database]
```

**Operadores soportados:**
- `>`, `<`, `>=`, `<=`, `===`, `!==`
- `&&` (AND), `||` (OR), `!` (NOT)
- `contains`, `startsWith`, `endsWith`

**Ejemplo real:**
```
Si {{$node.HTTPRequest.data.statusCode}} === 200
  â†’ Guardar en base de datos
Sino
  â†’ Enviar alerta a Slack
```

==== 3.4.2 Switch Node

Para **mÃºltiples condiciones** (como switch en programaciÃ³n).

```
switch(status) {
  case "premium": â†’ aplicar descuento
  case "bÃ¡sico": â†’ precio normal
  case "trial": â†’ hacer seguimiento
  default: â†’ contactar soporte
}
```

==== 3.4.3 Loop Node

Para **iterar sobre arrays** y procesar cada item.

```
Entrada: [item1, item2, item3]
Loop:
  - Para cada item
    - HTTP POST a API
    - Guardar resultado
Salida: [resultado1, resultado2, resultado3]
```

==== 3.4.4 Merge y Aggregate

- **Merge:** Combina dos ramas que divergieron. Ideal despuÃ©s de IF/Switch.
- **Aggregate:** Espera mÃºltiples ejecuciones para recopilar datos.

=== 3.5 Conectar Aplicaciones Populares

n8n soporta 400+ integraciones nativas. Los requisitos tÃ­picos:

1. **Crear cuenta en el servicio** (si no la tienes)
2. **Generar credenciales:**
   - API Key
   - OAuth token
   - ContraseÃ±a de app
3. **Conectar en n8n:** Click en el nodo â†’ "Create new credential"
4. **Autorizar:** Permitir que n8n acceda al servicio

==== Ejemplos principales:

**Google Workspace:**
- Gmail: Enviar emails, leer buzÃ³n
- Google Sheets: CRUD en spreadsheets
- Google Calendar: Crear eventos
- Google Drive: Gestionar archivos

**Microsoft 365:**
- Outlook: Enviar emails, leer calendario
- Teams: Enviar mensajes
- Excel: Leer/escribir hojas
- OneDrive: Gestionar archivos

**Ventas & CRM:**
- Salesforce: Crear leads, deals, accounts
- HubSpot: Sincronizar contactos
- Pipedrive: Gestionar pipeline de ventas

**E-commerce:**
- Shopify: Leer pedidos, sincronizar productos
- WooCommerce: Gestionar tienda WordPress
- Stripe: Procesar pagos

**Productividad:**
- Asana: Crear tareas y proyectos
- Jira: Crear tickets
- Trello: Crear tarjetas

=== 3.6 AutenticaciÃ³n

La autenticaciÃ³n permite que n8n acceda a APIs de forma segura.

==== Tipos de autenticaciÃ³n:

**1. API Key**
```
GET /api/endpoint?api_key=sk_1234567890
```
- Simple
- Guardar key en credenciales de n8n
- Riesgo: si se expone la key, alguien puede usarla

**2. OAuth 2.0** (estÃ¡ndar seguro)
```
1. Usuario hace click en "Connect Google"
2. Se abre ventana de login de Google
3. Usuario autoriza n8n
4. Google envÃ­a token a n8n
5. n8n guarda token encriptado
```
- Seguro (n8n nunca ve la contraseÃ±a)
- Permite permiso granular ("solo lectura en Sheets")
- Se usa con: Google, GitHub, Slack, Microsoft, Stripe

**3. Basic Auth**
```
Header: Authorization: Basic base64(user:password)
```
- Simple pero menos seguro
- Usar solo en conexiones HTTPS/SSL

**4. Bearer Token**
```
Header: Authorization: Bearer token_aqui
```
- Usado por muchas APIs modernas (ej: OpenAI, HuggingFace)

**5. Custom Headers**
```
Header: X-API-Key: sk_1234567890
Header: X-Custom-Auth: valor
```
- Cuando la API tiene requerimientos especiales

**Best Practices:**
- Nunca poner keys en hardcode en nodos
- Siempre usar credenciales de n8n (encriptadas)
- Rotar keys regularmente
- Usar secrets management en producciÃ³n (env variables)
- Auditar quiÃ©n tiene acceso a quÃ© credenciales

---

== MÃ“DULO 4: Expresiones y Variables

Las expresiones son el "pegamento" que permite que los datos fluyan dinÃ¡micamente a travÃ©s de los nodos. Sin expresiones, n8n solo podrÃ­a trabajar con valores estÃ¡ticos.

=== 4.1 Sintaxis de Expresiones

==== Â¿QuÃ© es una expresiÃ³n?

Una **expresiÃ³n** es cÃ³digo que accede, transforma y usa datos de nodos anteriores.

**Sintaxis bÃ¡sica:**
```
{{$node.nombreNodo.data.campo}}
```

**Desglose:**
- `{{` y `}}` â†’ Delimitador de expresiÃ³n
- `$node` â†’ Especial: acceso a datos de nodos
- `nombreNodo` â†’ Nombre del nodo anterior
- `.data` â†’ Los datos output del nodo
- `.campo` â†’ Campo especÃ­fico

**Ejemplo real:**
```
Si tengo un nodo "HTTP Request" que devuelve:
{
  "status": 200,
  "user": { "name": "Juan", "email": "juan@email.com" }
}

Puedo acceder a:
{{$node.HTTPRequest.data.status}}        â†’ 200
{{$node.HTTPRequest.data.user.name}}    â†’ "Juan"
{{$node.HTTPRequest.data.user.email}}   â†’ "juan@email.com"
```

==== 4.1.1 Acceder a Datos de Nodos Anteriores

```
$node.NombreNodo.data.campo
$node.NombreNodo.data.campo[0]          # Primer item
$node.NombreNodo.data[0].campo          # Arrays
$node.NombreNodo.data.objeto.propiedad  # Objetos anidados
```

**Tabla de operadores:**

[cols="1,2,3", options="header"]
|===
|Operador|Uso|Ejemplo

|`.`
|Acceder a propiedades
|{{$node.HTTP.data.user.name}}

|`[]`
|Acceder a arrays/Ã­ndices
|{{$node.HTTP.data.items[0]}}

|`?`
|Safe navigation (no falla si undefined)
|{{$node.HTTP.data?.user?.name}}

|`\|\|`
|OR: valor por defecto
|{{$node.data.email \|\| "sin-email@example.com"}}
|===

==== 4.1.2 Variables de Entorno

Variables que define n8n automÃ¡ticamente:

[cols="1,2,3", options="header"]
|===
|Variable|DescripciÃ³n|Ejemplo

|`$env.VARIABLE_NAME`
|Acceder a env vars del sistema
|{{$env.DATABASE_URL}}

|`$now`
|Fecha/hora actual
|{{$now.toISOString()}}

|`$item()`
|Item actual en loops
|{{$item(0).id}}

|`$workflow.id`
|ID del workflow
|{{$workflow.id}}

|`$execution.id`
|ID de la ejecuciÃ³n actual
|{{$execution.id}}
|===

==== 4.1.3 Funciones Integradas

n8n proporciona funciones JavaScript estÃ¡ndar:

**Strings:**
```
.toUpperCase()    â†’ MINÃšSCULAS a MAYÃšSCULAS
.toLowerCase()    â†’ MAY a min
.trim()           â†’ Quitar espacios
.split(",")       â†’ Dividir por separador
.includes("text") â†’ Â¿Contiene?
.substring(0, 5)  â†’ Extraer parte
```

**Arrays:**
```
.length           â†’ NÃºmero de items
.filter()         â†’ Filtrar items
.map()            â†’ Transformar cada item
.join(",")        â†’ Unir items
.includes()       â†’ Â¿Contiene valor?
```

**Math:**
```
Math.round()      â†’ Redondear
Math.floor()      â†’ Redondear hacia abajo
Math.ceil()       â†’ Redondear hacia arriba
Math.pow(x, y)    â†’ Potencia
Math.sqrt()       â†’ RaÃ­z cuadrada
```

**Dates:**
```
new Date()        â†’ Fecha actual
.toISOString()    â†’ Formato ISO
.getTime()        â†’ Milisegundos desde 1970
```

==== 4.1.4 Operadores

**AritmÃ©ticos:**
```
+  Suma: {{5 + 3}}  â†’ 8
-  Resta: {{10 - 4}} â†’ 6
*  MultiplicaciÃ³n: {{4 * 5}} â†’ 20
/  DivisiÃ³n: {{20 / 4}} â†’ 5
%  MÃ³dulo (resto): {{17 % 5}} â†’ 2
```

**ComparaciÃ³n:**
```
===  Igual: {{5 === 5}} â†’ true
!==  Diferente: {{5 !== 3}} â†’ true
>    Mayor: {{10 > 5}} â†’ true
<    Menor: {{10 < 5}} â†’ false
>=   Mayor o igual
<=   Menor o igual
```

**LÃ³gicos:**
```
&&   AND: {{true && false}} â†’ false
||   OR:  {{true || false}} â†’ true
!    NOT: {{!false}} â†’ true
?:   Ternario: {{edad >= 18 ? "mayor" : "menor"}}
```

=== 4.2 Expresiones Comunes

==== 4.2.1 Filtrado de Datos

Extraer datos especÃ­ficos de un array:

```javascript
// Datos de entrada:
// items = [{id:1,status:"active"}, {id:2,status:"inactive"}]

// Obtener solo activos:
{{$node.HTTP.data.items.filter(item => item.status === "active")}}

// Resultado: [{id:1,status:"active"}]
```

==== 4.2.2 TransformaciÃ³n de Strings

```javascript
// Convertir a mayÃºsculas
{{$node.Webhook.data.name.toUpperCase()}}

// Crear email desde nombre
nombre = "juan pÃ©rez"
{{nombre.toLowerCase().replace(" ", ".") + "@empresa.com"}}
// Resultado: juan.pÃ©rez@empresa.com

// Extraer parte de texto
{{$node.data.email.split("@")[0]}}  // Parte antes de @
```

==== 4.2.3 CÃ¡lculos MatemÃ¡ticos

```javascript
// Aplicar descuento
precio = 100
descuento = 20
{{precio * (1 - descuento / 100)}}  // 80

// Calcular edad
fechaNacimiento = "1990-01-15"
{{Math.floor(((new Date() - new Date(fechaNacimiento)) / (365 * 24 * 60 * 60 * 1000)))}}
```

==== 4.2.4 ManipulaciÃ³n de Fechas

```javascript
// Fecha actual
{{$now.toISOString()}}  // 2024-01-15T14:30:00.000Z

// Fecha de hace 7 dÃ­as
fecha_hace_7_dias = new Date($now.getTime() - (7 * 24 * 60 * 60 * 1000))
{{fecha_hace_7_dias.toISOString()}}

// Formatear fecha (mes-dÃ­a-aÃ±o)
{{$now.toLocaleDateString('es-ES')}}
```

==== 4.2.5 Acceso a Arrays y Objetos

```javascript
// Primer elemento
{{$node.data.items[0]}}

// Ãšltimo elemento
{{$node.data.items[-1]}}  // O
{{$node.data.items[$node.data.items.length - 1]}}

// Contar items
{{$node.data.items.length}}

// Crear array de nombres
{{$node.data.users.map(u => u.name)}}
// Resultado: ["Juan", "MarÃ­a", "Pedro"]

// Crear objeto desde datos
{{JSON.stringify({
  nombre: $node.Webhook.data.name,
  email: $node.Webhook.data.email,
  timestamp: $now.toISOString()
})}}
```

=== 4.3 Variables Globales

Las variables globales permiten reutilizar valores en mÃºltiples nodos.

==== 4.3.1 Definir Variables Globales

En el nodo **Set** o **Code**:

```javascript
// Usando Set Node:
1. Click en "Add Value"
2. Key: "nombreVariable"
3. Value: "tu_valor"

// Resultado en otros nodos:
{{$node.SetVariables.data.nombreVariable}}
```

==== 4.3.2 Usar en Workflows

```javascript
// Definir una variable de timestamp
// Set Node:
- Key: "startTime"
- Value: {{$now.toISOString()}}

// Usarla en un logging node 50 nodos despuÃ©s:
{{$node.SetVariables.data.startTime}}
```

==== 4.3.3 Expresiones DinÃ¡micas

```javascript
// Variable con expresiÃ³n, no valor fijo
// Set Node:
- Key: "mensajePersonalizado"
- Value: {{`Hola ${$node.Webhook.data.nombre}, tu correo es ${$node.Webhook.data.email}`}}

// Resultado: "Hola Juan, tu correo es juan@email.com"
```

==== 4.3.4 Scope de Variables

```javascript
// Variables locales (dentro de Set):
{{$node.MySetNode.data.variable}}

// Variables globales (definidas en credentials):
// (requiere acceso admin)
```

=== 4.4 TransformaciÃ³n de Datos

==== 4.4.1 Mapeo de Campos

Cambiar estructura de datos:

```javascript
// Entrada:
{
  "id": "123",
  "first_name": "Juan",
  "last_name": "PÃ©rez"
}

// Usar Set Node para reorganizar:
Key: "usuario"
Value: {{JSON.stringify({
  id: $node.Webhook.data.id,
  nombre_completo: $node.Webhook.data.first_name + " " + $node.Webhook.data.last_name,
  email_tipo: "empresa"
})}}

// Salida:
{
  "usuario": {
    "id": "123",
    "nombre_completo": "Juan PÃ©rez",
    "email_tipo": "empresa"
  }
}
```

==== 4.4.2 ConversiÃ³n de Tipos

```javascript
// String a nÃºmero
{{Number("42")}}  â†’ 42
{{parseInt("42")}}  â†’ 42

// NÃºmero a string
{{String(42)}}  â†’ "42"
{{(42).toString()}}  â†’ "42"

// String a JSON
{{JSON.parse('{"id": 123}')}}  â†’ {id: 123}

// JSON a string
{{JSON.stringify({id: 123})}}  â†’ '{"id":123}'

// String a boolean
{{$node.data.valor === "true" ? true : false}}
```

==== 4.4.3 ValidaciÃ³n de Datos

```javascript
// Â¿Es email vÃ¡lido?
{{/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test($node.Webhook.data.email)}}

// Â¿Tiene valor?
{{$node.Webhook.data.nombre !== undefined && $node.Webhook.data.nombre !== ""}}

// Â¿NÃºmero es positivo?
{{$node.Webhook.data.precio > 0}}
```

==== 4.4.4 Limpieza de Datos

```javascript
// Remover espacios
{{$node.data.nombre.trim()}}

// Remover espacios extras
{{$node.data.descripcion.replace(/\s+/g, " ")}}

// Convertir a minÃºsculas y eliminar acentos
{{$node.data.ciudad.toLowerCase()}}

// Sanitizar para SQL (cuidado con inyecciÃ³n)
{{$node.data.username.replace(/[';\"]/g, "")}}

// Truncar texto a X caracteres
{{$node.data.descripcion.substring(0, 100)}}
```

---

== MÃ“DULO 5: Control de Flujo

El control de flujo permite que tus workflows tomen decisiones automÃ¡ticas y procesen datos complejos.

=== 5.1 Condicionales (IF)

==== Concepto BÃ¡sico

El nodo IF evalÃºa una condiciÃ³n (verdadero/falso) y ejecuta uno de dos caminos:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Entrada    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
   â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”
   â”‚ CondiciÃ³nâ”‚ Â¿Es precio > 100?
   â””â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”˜
       â”‚    â”‚
      SÃ   NO
       â”‚    â”‚
    â”Œâ”€â”€â–¼â”€â”â”Œâ”€â–¼â”€â”€â”
    â”‚PATHâ”‚PATH â”‚
    â”‚ A  â”‚ B   â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜
```

==== Ejemplos PrÃ¡cticos

**Ejemplo 1: Notificar solo si monto es alto**
```
CondiciÃ³n: {{$node.Webhook.data.amount}} > 1000
- True: Slack notification "Â¡Venta grande!"
- False: Log en base de datos (sin notificaciÃ³n)
```

**Ejemplo 2: Validar antes de procesar**
```
CondiciÃ³n: {{$node.Webhook.data.email}}.includes("@")
- True: Procesar cliente
- False: Enviar email de error
```

**Ejemplo 3: CondiciÃ³n compleja (AND/OR)**
```
CondiciÃ³n:
({{$node.data.cantidad}} > 0 && {{$node.data.precio}} > 0)
||
({{$node.data.estado}} === "promocion")

- True: Crear pedido
- False: Rechazar solicitud
```

==== 5.1.1 Operadores Soportados

[cols="1,2,3", options="header"]
|===
|Operador|Significado|Ejemplo

|`===`
|Igual (exacto)
|{{status}} === "activo"

|`!==`
|Diferente
|{{status}} !== "cancelado"

|`>`
|Mayor
|{{price}} > 100

|`>=`
|Mayor o igual
|{{edad}} >= 18

|`<`
|Menor
|{{stock}} < 10

|`<=`
|Menor o igual
|{{dias_vencimiento}} <= 0

|`.includes()`
|Contiene (string/array)
|{{email}}.includes("@")

|`.startsWith()`
|Comienza con
|{{codigo}}.startsWith("PRE")

|`&&`
|AND (ambas verdaderas)
|{{a}} > 0 && {{b}} > 0

|`\|\|`
|OR (una es verdadera)
|{{tipo}} === "A" \|\| {{tipo}} === "B"

|`!`
|NOT (negaciÃ³n)
|!{{enviado}}
|===

=== 5.2 Switch y RamificaciÃ³n

Para mÃºltiples opciones (mÃ¡s que SÃ/NO), usa **Switch**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  tipo_dato  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
   â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚    SWITCH     â”‚
   â””â”€â”¬â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”˜
     â”‚ â”‚  â”‚  â”‚  â”‚
   "A""B""C""D"otro
     â”‚ â”‚  â”‚  â”‚  â”‚
    â”Œâ”€â–¼â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”€â”€â”
    â”‚ Ejecuta camino   â”‚
    â”‚ correspondiente  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Ejemplo:**
```
Variable: {{$node.data.tipocliente}}

Switch cases:
- "premium" â†’ Aplicar 20% descuento
- "bÃ¡sico" â†’ Aplicar 0% descuento
- "trial" â†’ Enviar seguimiento
- default â†’ Contactar soporte
```

=== 5.3 Loops e IteraciÃ³n

Procesa cada item en un array automÃ¡ticamente:

```
Entrada: [item1, item2, item3, item4, item5]

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    LOOP Node    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Para CADA item:      â”‚
    â”‚ - HTTP POST a API    â”‚
    â”‚ - Log resultado      â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
Salida: [result1, result2, result3, result4, result5]
```

**Caso de uso:** Procesar 100 Ã³rdenes en un workflow, no 100 workflows diferentes.

**ConfiguraciÃ³n:**
```
Loop sobre: {{$node.HTTPRequest.data}}
(itera automÃ¡ticamente si es array)

Acceder al item actual:
{{$item().id}}        // ID del item
{{$item().name}}      // Nombre del item
{{$index()}}          // Ãndice actual (0, 1, 2, ...)
```

=== 5.4 Merge y CombinaciÃ³n de Datos

DespuÃ©s de un IF/Switch con dos ramas, necesitas **Merge** para combinarlas:

```
         IF
        â•±  â•²
    Rama A  Rama B
    [out1]  [out2]
        â•²  â•±
       MERGE
        â”‚
   [out1, out2]
```

**Tipos de Merge:**

1. **Merge simple:** Combina todos los datos
2. **Merge con lÃ³gica:** Solo datos que cumplan criterios
3. **Merge customizado:** CÃ³digo personalizado

=== 5.5 Error Handling (Manejo de Errores)

Los errores suceden. Los workflows roburos los manejan.

==== 5.5.1 Continue on Fail

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ HTTP Request â”‚
â”‚ (puede fallar)
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
   Â¿FallÃ³? SÃ â†’ [Continue] â†’ Ejecutar siguiente nodo
       â”‚
       NO â†’ Ejecutar siguiente nodo
       â”‚
   â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Siguiente  â”‚
   â”‚ nodo igual â”‚
   â”‚ en ambos   â”‚
   â”‚ casos      â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Uso:** Cuando una acciÃ³n es "nice to have" pero no es crÃ­tica.

==== 5.5.2 Try-Catch Equivalente

Combina IF + mensaje de error:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ HTTP Requestâ”‚ URL: {{url}}
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
   Â¿Status===200?
       â”‚
   SÃ  NO
   â”‚   â”‚
 Ã‰XITO ERROR
   â”‚   â”‚
   â”‚  Email admin: "HTTP fallÃ³"
   â”‚  Slack: "Workflow error"
   â”‚
   â””â”€â†’ Merge â†’ Siguiente nodo
```

==== 5.5.3 Reintentos AutomÃ¡ticos

n8n permite reintentos en nodos especÃ­ficos:

```
Nodo: HTTP Request
ConfiguraciÃ³n:
- Retry on error: YES
- Max retries: 3
- Wait between: 5 segundos
- Retry on: 500, 502, 503 (errores de servidor)
```

Beneficio: RecuperaciÃ³n automÃ¡tica de fallos temporales.

==== 5.5.4 Notificaciones de Error

```
Si workflow falla:
1. n8n envÃ­a email al owner
2. Opcionalmente: enviar a Slack
3. Log en dashboard

ConfiguraciÃ³n en workflow:
Settings â†’ Error handling â†’ Email on error
```

---

== MÃ“DULO 6: GestiÃ³n de Datos

En este mÃ³dulo aprenderemos a trabajar con datos en n8n: lectura desde mÃºltiples fuentes, transformaciÃ³n, almacenamiento y manipulaciÃ³n usando patrones CRUD.

=== 6.1 Lectura de Datos

==== Conceptos Fundamentales

La lectura de datos es la base de cualquier workflow. n8n permite obtener datos de mÃºltiples fuentes:

**1. HTTP GET Requests**

El nodo HTTP Request es el mÃ¡s versÃ¡til para obtener datos de APIs REST:

[source,javascript]
----
// Ejemplo de lectura simple desde una API
GET https://api.ejemplo.com/usuarios?limite=10

// Headers comunes
Content-Type: application/json
Authorization: Bearer {token}
----

**Ventajas:**
* No requiere integraciÃ³n especÃ­fica
* Funciona con cualquier API REST
* Soporta autenticaciÃ³n (Basic, Bearer, OAuth)
* Manejo flexible de respuestas

**2. Bases de Datos (MySQL, PostgreSQL, SQLite)**

Para conectar a bases de datos, n8n proporciona nodos especÃ­ficos que ejecutan queries SQL:

[source,sql]
----
-- Lectura bÃ¡sica
SELECT * FROM usuarios WHERE activo = 1;

-- Con filtros dinÃ¡micos
SELECT * FROM usuarios WHERE email LIKE $1;

-- AggregaciÃ³n de datos
SELECT fecha, COUNT(*) as total FROM pedidos GROUP BY fecha;
----

**3. Google Sheets**

IntegraciÃ³n nativa para leer datos directamente desde hojas de cÃ¡lculo:

* Acceso con credenciales de Google
* Rango especificado de celdas
* ConversiÃ³n automÃ¡tica de tipos de datos
* CachÃ© de lecturas para mejor performance

**4. Airtable**

API de Airtable integrada en n8n:

[source,javascript]
----
// Leer registro de Airtable
GET https://api.airtable.com/v0/{baseId}/{tableId}

// Filtrar registros
GET https://api.airtable.com/v0/{baseId}/{tableId}?filterByFormula={FIELD}='{value}'
----

**Ejemplo PrÃ¡ctico: Lectura de API REST**

Archivo: `ejemplos/n8n/modulo6/01-lectura-api-rest.json`

Este workflow demuestra:
1. Obtener usuario desde JSONPlaceholder API
2. Obtener posts del usuario con segunda request
3. Transformar datos en formato Ãºtil

[source,json]
----
{
  "nodo": "HTTP Request",
  "mÃ©todo": "GET",
  "url": "https://jsonplaceholder.typicode.com/users/1",
  "resultado": {
    "id": 1,
    "name": "Leanne Graham",
    "email": "Bret@april.biz",
    "phone": "1-770-736-8031 x56442",
    "website": "hildegard.org"
  }
}
----

=== 6.2 Escritura de Datos

==== Almacenamiento y Persistencia

Una vez procesados, los datos deben guardarse en algÃºn destino:

**1. HTTP POST Requests**

Enviar datos a APIs externas:

[source,javascript]
----
POST https://api.ejemplo.com/usuarios
Content-Type: application/json

{
  "nombre": "Juan GarcÃ­a",
  "email": "juan@example.com",
  "edad": 28
}
----

**2. Escritura en Bases de Datos**

Insertar registros en bases de datos:

[source,sql]
----
INSERT INTO usuarios (nombre, email, edad)
VALUES ($1, $2, $3);

-- Insertar mÃºltiples registros
INSERT INTO usuarios (nombre, email, edad) VALUES
('Juan', 'juan@example.com', 28),
('MarÃ­a', 'maria@example.com', 32),
('Carlos', 'carlos@example.com', 25);
----

**3. Archivos (JSON, CSV)**

Guardar datos en el filesystem:

[source,bash]
----
# JSON con estructura anidada
{
  "usuarios": [
    {"id": 1, "nombre": "Juan", "email": "juan@example.com"},
    {"id": 2, "nombre": "MarÃ­a", "email": "maria@example.com"}
  ],
  "timestamp": "2024-01-15T10:30:00Z"
}

# CSV con encabezados
id,nombre,email,edad
1,Juan,juan@example.com,28
2,MarÃ­a,maria@example.com,32
----

**4. Google Sheets**

Agregar filas a hojas de cÃ¡lculo automÃ¡ticamente

**5. Airtable**

Crear registros en tablas de Airtable

**Ejemplo PrÃ¡ctico: Escritura de Archivos JSON**

Archivo: `ejemplos/n8n/modulo6/02-escritura-archivo-json.json`

Este workflow:
1. Prepara una estructura JSON con usuarios
2. Procesa y valida los datos
3. Guarda el archivo en `/tmp/n8n_usuarios.json`
4. Lee el archivo para verificar la escritura

=== 6.3 ActualizaciÃ³n y EliminaciÃ³n

==== Operaciones UPDATE y DELETE

Modificar datos existentes es fundamental en workflows de gestiÃ³n:

**1. HTTP PUT/PATCH Requests**

[source,javascript]
----
// PUT: Reemplazar el recurso completo
PUT https://api.ejemplo.com/usuarios/123
Content-Type: application/json

{
  "nombre": "Juan GarcÃ­a Actualizado",
  "email": "juan_nuevo@example.com",
  "edad": 29
}

// PATCH: ActualizaciÃ³n parcial
PATCH https://api.ejemplo.com/usuarios/123
Content-Type: application/json

{
  "edad": 29
}
----

**2. UPDATE en Bases de Datos**

[source,sql]
----
-- Actualizar un registro
UPDATE usuarios
SET edad = edad + 1,
    fecha_actualizacion = NOW()
WHERE id = 123;

-- Actualizar mÃºltiples registros con condiciÃ³n
UPDATE usuarios
SET estado = 'inactivo'
WHERE Ãºltima_actividad < NOW() - INTERVAL 90 DAY;

-- Actualizar con JOIN
UPDATE usuarios u
SET u.estado = 'vip'
WHERE u.id IN (
  SELECT user_id FROM pedidos
  WHERE total > 1000
  GROUP BY user_id
);
----

**3. DELETE - EliminaciÃ³n de Registros**

[source,sql]
----
-- Eliminar registros especÃ­ficos
DELETE FROM usuarios WHERE id = 123;

-- Eliminar con condiciÃ³n
DELETE FROM usuarios WHERE estado = 'inactivo' AND Ãºltima_actividad < DATE_SUB(NOW(), INTERVAL 1 YEAR);

-- Truncate: Limpiar tabla completamente (mÃ¡s rÃ¡pido)
TRUNCATE TABLE usuarios_temporales;
----

**Ejemplo PrÃ¡ctico: TransformaciÃ³n de Datos**

Archivo: `ejemplos/n8n/modulo6/03-transformacion-datos.json`

Este workflow demuestra:
1. Recibir datos sin procesar (normalizados)
2. Transformar y normalizar nombres/emails
3. Enriquecer con campos calculados
4. Crear estadÃ­sticas resumidas

=== 6.4 Trabajar con Bases de Datos

==== Opciones de Bases de Datos

**SQLite (Recomendado para desarrollo local)**

Ventajas:
* Sin configuraciÃ³n, ya incluido en n8n
* Perfecto para prototipos
* Archivo Ãºnico, fÃ¡cil de hacer backup

[source,sql]
----
-- Crear tabla
CREATE TABLE usuarios (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  nombre TEXT NOT NULL,
  email TEXT UNIQUE,
  edad INTEGER,
  estado TEXT DEFAULT 'activo',
  fecha_creacion TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Ãndices para mejorar performance
CREATE INDEX idx_email ON usuarios(email);
CREATE INDEX idx_estado ON usuarios(estado);
----

**PostgreSQL (ProducciÃ³n)**

Ventajas:
* Robusto y escalable
* Soporte para tipos complejos (JSON, Arrays)
* Transacciones ACID completas
* Connection pooling

[source,sql]
----
-- Crear tabla con tipos avanzados
CREATE TABLE usuarios (
  id SERIAL PRIMARY KEY,
  nombre VARCHAR(255) NOT NULL,
  email VARCHAR(255) UNIQUE,
  edad INTEGER,
  metadata JSONB,
  estado VARCHAR(20) DEFAULT 'activo',
  fecha_creacion TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Query JSONB
SELECT * FROM usuarios WHERE metadata->>'tipo' = 'premium';
----

**MySQL**

Ventajas:
* Ampliamente soportado
* Buena performance en lectura
* Compatible con muchas aplicaciones

**Conexiones Persistentes**

En n8n, las conexiones a BD se pueden configurar para:
* ReutilizaciÃ³n en mÃºltiples workflows
* Pool de conexiones
* Timeout y reintentos

**Ejemplo PrÃ¡ctico: CRUD Completo con SQLite**

Archivo: `ejemplos/n8n/modulo6/04-crud-sqlite.json`

Este workflow implementa todas las operaciones:
1. CREATE TABLE: Crear estructura de tabla
2. INSERT: AÃ±adir registros iniciales
3. SELECT: Leer datos con filtros
4. UPDATE: Modificar registros existentes
5. DELETE: Eliminar registros segÃºn condiciÃ³n
6. VerificaciÃ³n final de datos

=== 6.5 CSV y Excel

==== Procesamiento de Archivos Estructurados

**Leer Archivos CSV**

[source,javascript]
----
// n8n automatiza el parsing de CSV
// El nodo "Read File" puede procesar CSV

// Ejemplo de contenido CSV
id,nombre,email,departamento,salario
1,Juan GarcÃ­a,juan@company.com,Ventas,35000
2,MarÃ­a LÃ³pez,maria@company.com,Desarrollo,42000
3,Carlos RodrÃ­guez,carlos@company.com,Operaciones,38000

// n8n lo convierte automÃ¡ticamente a JSON array
[
  {
    "id": "1",
    "nombre": "Juan GarcÃ­a",
    "email": "juan@company.com",
    "departamento": "Ventas",
    "salario": "35000"
  },
  ...
]
----

**Procesar Datos**

Una vez en formato JSON, se pueden:
* Filtrar registros
* Transformar valores
* Validar datos
* Enriquecer con informaciÃ³n adicional

**Crear Archivos CSV**

[source,javascript]
----
// Usar Code Node o expresiones para convertir a CSV
const headers = Object.keys(data[0]).join(',');
const rows = data.map(obj =>
  Object.values(obj).join(',')
);
const csv = [headers, ...rows].join('\n');

// Luego guardar con Write File
----

**Trabajar con Excel (Microsoft 365)**

* Leer y escribir hojas especÃ­ficas
* Conservar formato
* Acceso a mÃºltiples hojas en un libro
* Compatible con fÃ³rmulas Excel

==== Mejores PrÃ¡cticas de GestiÃ³n de Datos

**1. ValidaciÃ³n**

Siempre validar antes de escribir:

[source,javascript]
----
const validar = (usuario) => {
  const errores = [];

  if (!usuario.email || !usuario.email.includes('@')) {
    errores.push('Email invÃ¡lido');
  }
  if (!usuario.nombre || usuario.nombre.length < 3) {
    errores.push('Nombre muy corto');
  }
  if (usuario.edad && (usuario.edad < 18 || usuario.edad > 120)) {
    errores.push('Edad fuera de rango');
  }

  return {
    valido: errores.length === 0,
    errores: errores
  };
};
----

**2. Manejo de Errores**

Implementar reintentos y fallbacks:

[source,javascript]
----
// Retry logic en n8n
try {
  // Intentar operaciÃ³n
  const resultado = await escribirEnBD(datos);
  return resultado;
} catch (error) {
  if (error.code === 'DUPLICATE_KEY') {
    // Manejar duplicados
    return actualizarEnLugarDeInsertar(datos);
  }
  throw error;
}
----

**3. Performance**

* Batch inserts: Insertar mÃºltiples registros en una query
* Ãndices: Crear Ã­ndices para bÃºsquedas frecuentes
* Queries eficientes: Evitar N+1 queries
* CachÃ©: Guardar datos frecuentes en memoria

**Ejemplo PrÃ¡ctico: Procesamiento con Ollama**

Archivo: `ejemplos/n8n/modulo6/05-ollama-data-processing.json`

Este workflow demuestra integraciÃ³n con IA:
1. Preparar textos para anÃ¡lisis
2. Enviar a Ollama (modelo local) para procesamiento
3. Extraer resultados
4. Crear resumen de sentimientos

Requisito: `ollama serve` corriendo en http://localhost:11434

==== Resumen del MÃ³dulo 6

Has aprendido a:
âœ“ Leer datos de mÃºltiples fuentes (APIs, BD, archivos)
âœ“ Escribir y guardar datos en destinos diversos
âœ“ Transformar y normalizar datos
âœ“ Implementar operaciones CRUD completas
âœ“ Procesar datos con IA local (Ollama)
âœ“ Validar y manejar errores
âœ“ Optimizar rendimiento en operaciones de datos

**PrÃ³ximo paso:** MÃ³dulo 7 - Webhooks y APIs

---

== MÃ“DULO 7: Webhooks y APIs

En este mÃ³dulo aprenderemos a crear webhooks en n8n para recibir datos externos, y a consumir APIs de terceros de forma segura y eficiente.

=== 7.1 Crear Webhooks en n8n

==== Â¿QuÃ© es un Webhook?

Un webhook es un mecanismo que permite a aplicaciones externas enviar datos a n8n de forma proactiva. Es lo opuesto a una API REST donde el cliente solicita datos.

**CaracterÃ­sticas de Webhooks en n8n:**

* **URL Ãšnica**: Cada workflow con trigger webhook genera una URL Ãºnica
* **MÃ©todos HTTP**: Soporta GET, POST, PUT, DELETE, PATCH
* **AsincronÃ­a**: Procesa solicitudes en segundo plano
* **Escalabilidad**: Maneja mÃºltiples solicitudes simultÃ¡neas

**Estructura de URL del Webhook:**

[source,bash]
----
https://tu-instancia-n8n.com/webhook/nombre-unique
https://localhost:5678/webhook/form-signup
----

**MÃ©todos HTTP Soportados:**

* **GET**: Recibir parÃ¡metros en query string
* **POST**: Recibir datos en body (JSON, form-data)
* **PUT/PATCH**: Actualizar recursos
* **DELETE**: Eliminar recursos

**ParÃ¡metros y Query Strings:**

[source,javascript]
----
// Acceder a parÃ¡metros en n8n
$input.first().json.queryParameters    // Query strings
$input.first().json.body              // Body POST
$input.first().json.headers           // Headers HTTP
$input.first().json.method            // MÃ©todo HTTP usado
----

**Headers Personalizados:**

[source,bash]
----
# Enviar datos al webhook con headers
curl -X POST http://localhost:5678/webhook/mi-webhook \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer token123" \
  -d '{"nombre": "Juan", "email": "juan@example.com"}'

# En n8n, acceder a headers
$input.first().json.headers['authorization']
----

**Ejemplo PrÃ¡ctico: Webhook BÃ¡sico**

Archivo: `ejemplos/n8n/modulo7/01-webhook-basico.json`

Este workflow:
1. Expone un endpoint HTTP
2. Recibe datos POST
3. Procesa los datos
4. Retorna respuesta

=== 7.2 Consumir APIs Externas

==== Nodo HTTP Request

El nodo HTTP Request es el mÃ¡s versÃ¡til para consumir APIs:

**MÃ©todos HTTP:**

[source,javascript]
----
// GET - Obtener datos
GET /api/usuarios/123

// POST - Crear recursos
POST /api/usuarios
Body: { "nombre": "Juan", "email": "juan@example.com" }

// PUT - Reemplazar completo
PUT /api/usuarios/123
Body: { "nombre": "Juan GarcÃ­a", ... }

// PATCH - ActualizaciÃ³n parcial
PATCH /api/usuarios/123
Body: { "nombre": "Juan GarcÃ­a" }

// DELETE - Eliminar
DELETE /api/usuarios/123
----

**Headers Personalizados:**

[source,javascript]
----
// Headers comunes
Content-Type: application/json
Accept: application/json
User-Agent: n8n/1.0

// Headers de autenticaciÃ³n
Authorization: Bearer {token}
X-API-Key: {apikey}
----

**Body y ParÃ¡metros:**

[source,javascript]
----
// JSON Body
{
  "nombre": "Juan",
  "email": "juan@example.com",
  "edad": 28,
  "activo": true
}

// Query Parameters
?filtro=activos&limite=10&pagina=1

// Form Data
name=Juan&email=juan@example.com
----

**Manejo de Respuestas:**

[source,javascript]
----
// Acceder a respuesta JSON
$input.first().json.data
$input.first().json.usuarios[0].nombre

// Acceder a headers de respuesta
$input.first().json.headers['content-type']

// CÃ³digo de estado HTTP
$input.first().json.statusCode
----

**Errores y CÃ³digos HTTP:**

[source,javascript]
----
// CÃ³digos de Ã©xito
200 OK             - Solicitud exitosa
201 Created        - Recurso creado
204 No Content     - Ã‰xito sin contenido

// Errores de cliente
400 Bad Request    - Solicitud invÃ¡lida
401 Unauthorized   - Sin autenticaciÃ³n
403 Forbidden      - Sin permiso
404 Not Found      - Recurso no existe
429 Too Many       - Rate limit excedido

// Errores de servidor
500 Server Error   - Error interno
503 Service Unavailable - Servicio no disponible
----

**Ejemplo PrÃ¡ctico: Consumir API PÃºblica**

Archivo: `ejemplos/n8n/modulo7/02-consumir-api-publica.json`

Este workflow obtiene datos de Open-Meteo (clima sin autenticaciÃ³n):
1. Solicita datos de clima para Madrid
2. Procesa la respuesta
3. Transforma a formato legible

=== 7.3 AutenticaciÃ³n en APIs

==== MÃ©todos de AutenticaciÃ³n

**1. API Key**

MÃ©todo simple, la API key va en header:

[source,bash]
----
# Header
X-API-Key: tu_api_key_aqui

# Query Parameter
?api_key=tu_api_key_aqui

# Bearer Style
Authorization: ApiKey tu_api_key_aqui
----

Uso en n8n:

[source,javascript]
----
// En HTTP Request node
Headers:
  X-API-Key: {{ $env.MI_API_KEY }}
----

**2. Bearer Token / JWT**

Token en Authorization header (estÃ¡ndar OAuth2):

[source,bash]
----
Authorization: Bearer eyJhbGc...
----

Ventajas:
* EstÃ¡ndar HTTP
* Soporta JWT
* Control de expiraciÃ³n
* Refresh tokens

**3. Basic Authentication**

Usuario y contraseÃ±a en Base64:

[source,bash]
----
Authorization: Basic dXNlcjpwYXNzd29yZA==
# (user:password en Base64)
----

CÃ³digo en n8n:

[source,javascript]
----
const auth = Buffer.from('usuario:contraseÃ±a').toString('base64');
headers: {
  'Authorization': 'Basic ' + auth
}
----

**4. OAuth 2.0**

Flujo seguro para delegaciÃ³n de acceso:

[source,javascript]
----
// 1. Redirigir a servidor de autorizaciÃ³n
GET https://oauth-server.com/authorize
  ?client_id=tu_cliente_id
  &redirect_uri=https://n8n.com/callback
  &scope=read%20write

// 2. Usuario autoriza
// 3. Recibir authorization code
// 4. Intercambiar por access token
POST https://oauth-server.com/token
  client_id=tu_cliente_id
  client_secret=tu_secreto
  code=authorization_code

// 5. Usar access token
Authorization: Bearer access_token_aqui
----

**5. Custom Headers**

APIs que requieren headers personalizados:

[source,javascript]
----
// Ejemplo: API que requiere versiÃ³n
X-API-Version: v2
X-Client-ID: tu_cliente_id
X-Timestamp: 1234567890
X-Signature: hash_del_payload

// En n8n, crear dinÃ¡micamente
const timestamp = Math.floor(Date.now() / 1000);
const signature = crypto
  .createHmac('sha256', apiSecret)
  .update(body + timestamp)
  .digest('hex');
----

**Ejemplo PrÃ¡ctico: AutenticaciÃ³n en APIs**

Archivo: `ejemplos/n8n/modulo7/05-autenticacion-apis.json`

Este workflow demuestra:
1. API Key en headers
2. Bearer Token
3. Basic Authentication
4. DocumentaciÃ³n de mÃ©todos

=== 7.4 APIs PÃºblicas Populares

==== Ejemplos de IntegraciÃ³n

**Open-Meteo (Clima)**

[source,bash]
----
GET https://api.open-meteo.com/v1/forecast
  ?latitude=40.4168
  &longitude=-3.7038
  &current=temperature_2m,weather_code

# No requiere autenticaciÃ³n
# LÃ­mite: 10,000 requests/dÃ­a gratis
----

**JSONPlaceholder (Testing)**

[source,bash]
----
# API de prueba con datos ficticios
GET https://jsonplaceholder.typicode.com/users
GET https://jsonplaceholder.typicode.com/posts
GET https://jsonplaceholder.typicode.com/comments

# Perfecto para desarrollo y testing
----

**GraphQL**

[source,graphql]
----
query {
  user(id: 1) {
    name
    email
    posts(first: 10) {
      edges {
        node {
          id
          title
        }
      }
    }
  }
}
----

Usar en n8n:

[source,javascript]
----
Method: POST
URL: https://api.example.com/graphql
Body: {
  query: `query { user(id: 1) { name email } }`
}
----

=== 7.5 Rate Limiting y Throttling

==== Proteger APIs contra Sobrecarga

**Rate Limiting BÃ¡sico:**

[source,javascript]
----
// Limitar a 10 requests por minuto
const ventana = 60000;  // 1 minuto
const limite = 10;
const ahora = Date.now();

// Verificar lÃ­mite
if (requestsEnVentana >= limite) {
  throw new Error('Rate limit excedido');
}
----

**Implementar Delay entre Requests:**

[source,javascript]
----
// Usar nodo Delay en n8n
// Esperar 1 segundo entre requests
Delay node: 1 second

// Para mÃºltiples requests, esperar entre cada uno
for (let i = 0; i < items.length; i++) {
  // Procesar item
  await wait(1000);  // 1 segundo
}
----

**Manejar 429 Too Many Requests:**

[source,javascript]
----
// Implementar retry con backoff exponencial
async function fetchConRetry(url, maxRetries = 3) {
  for (let i = 0; i < maxRetries; i++) {
    try {
      const response = await fetch(url);
      if (response.status === 429) {
        const delay = Math.pow(2, i) * 1000; // Backoff exponencial
        await new Promise(resolve => setTimeout(resolve, delay));
        continue;
      }
      return response;
    } catch (error) {
      if (i === maxRetries - 1) throw error;
    }
  }
}
----

**Colas de Procesamiento:**

[source,javascript]
----
// Procesar en paralelo limitado (ej: 3 a la vez)
const items = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
const parallelLimit = 3;

for (let i = 0; i < items.length; i += parallelLimit) {
  const batch = items.slice(i, i + parallelLimit);
  await Promise.all(batch.map(item => processItem(item)));
}
----

**Ejemplo PrÃ¡ctico: Rate Limiting**

Archivo: `ejemplos/n8n/modulo7/04-rate-limiting.json`

Este workflow implementa:
1. VerificaciÃ³n de lÃ­mites
2. Delay entre solicitudes
3. Consulta a Ollama con rate limiting

==== Resumen del MÃ³dulo 7

Has aprendido a:
âœ“ Crear webhooks para recibir datos externos
âœ“ Consumir APIs REST con diversos mÃ©todos
âœ“ Implementar autenticaciÃ³n segura
âœ“ Trabajar con APIs pÃºblicas
âœ“ Proteger contra rate limiting
âœ“ Manejar errores y reintentos

**PrÃ³ximo paso:** MÃ³dulo 8 - Casos de Uso PrÃ¡cticos

---

== MÃ“DULO 8: Casos de Uso PrÃ¡cticos

=== 8.1 AutomatizaciÃ³n de Email
* Enviar emails automÃ¡ticos
* Emails con templates
* Attachments
* Triggers por eventos
* Listas de correo

=== 8.2 SincronizaciÃ³n de Datos
* Sincronizar Google Sheets con Airtable
* Sincronizar CRM con base de datos
* Duplicar registros entre servicios
* Bi-directional sync

=== 8.3 Procesamiento de Formularios
* Capturar datos de formularios
* ValidaciÃ³n
* Guardar en base de datos
* Enviar confirmaciones
* Integrar con email

=== 8.4 GestiÃ³n de Redes Sociales
* Publicar en Twitter
* Programar posts
* Responder mensajes
* Monitoreo de menciones

=== 8.5 E-commerce
* SincronizaciÃ³n de pedidos
* Inventario
* Notificaciones a clientes
* IntegraciÃ³n con Shopify

=== 8.6 CRM y Ventas
* Crear leads
* Actualizar oportunidades
* Seguimiento automÃ¡tico
* IntegraciÃ³n Salesforce/HubSpot

=== 8.7 Reportes y AnÃ¡lisis
* Generar reportes diarios
* Enviar por email
* Visualizaciones
* Exportar a Excel

=== 8.8 Backup y Archivado
* Backup de bases de datos
* Archivado de archivos
* Limpiar datos antiguos
* Copias en la nube

---

== MÃ“DULO 9: Nodos Avanzados

=== 9.1 Code Node (JavaScript)
* Ejecutar cÃ³digo JavaScript
* Acceder a datos de nodos anteriores
* Transformaciones complejas
* LibrerÃ­as disponibles
* Debugging

=== 9.2 Function Node
* Expresiones simples
* LÃ³gica sin escribir cÃ³digo
* Performance vs Code Node

=== 9.3 Python Node (con docker)
* Ejecutar cÃ³digo Python
* LibrerÃ­as disponibles
* Transformaciones complejas

=== 9.4 SQLite Node
* Crear queries
* Transacciones
* Migraciones

=== 9.5 Nodos de ProgramaciÃ³n
* Schedule (Cron expressions)
* Delay
* Wait
* Pause

---

== MÃ“DULO 10: Monitoreo y Debugging

=== 10.1 Testing Workflows
* Test individual nodes
* Test flujos completos
* Datos de prueba
* Simular triggers

=== 10.2 EjecuciÃ³n y Logs
* Historial de ejecuciones
* Ver logs detallados
* Identificar errores
* Performance metrics

=== 10.3 Debugging Avanzado
* Breakpoints
* Inspeccionar variables
* Pasos de ejecuciÃ³n
* Console output

=== 10.4 Monitoreo de Workflows
* Estado de workflows
* Alertas de errores
* Notificaciones
* EstadÃ­sticas de uso

---

== MÃ“DULO 11: Seguridad y Mejores PrÃ¡cticas

=== 11.1 Seguridad
* Credenciales y secrets
* Variables de entorno
* EncriptaciÃ³n de datos
* Control de acceso
* AuditorÃ­a

=== 11.2 Mejores PrÃ¡cticas
* Nombrar workflows descriptivamente
* Documentar workflows
* Versionamiento
* ReutilizaciÃ³n de workflows
* ModularizaciÃ³n

=== 11.3 Rendimiento
* Optimizar queries
* Limitar loops
* CachÃ© de datos
* ParalelizaciÃ³n

=== 11.4 Manejo de Errores
* Try-catch patterns
* Retry logic
* Fallback actions
* Logging de errores

=== 11.5 OrganizaciÃ³n
* Carpetas y categorÃ­as
* Tags
* BÃºsqueda
* Importar/Exportar

---

== MÃ“DULO 12: IntegraciÃ³n Avanzada

=== 12.1 Webhooks Bidireccionales
* Recibir y enviar datos
* Confirmaciones
* Reintentos

=== 12.2 APIs GraphQL
* Queries
* Mutations
* Subscriptions

=== 12.3 Integraciones Complejas
* Multi-step workflows
* Dependencias entre nodos
* Estados persistentes

=== 12.4 Webhook Templates
* Reutilizar webhooks
* DinÃ¡micos segÃºn parÃ¡metros

---

== MÃ“DULO 13: InstalaciÃ³n y Deployment

=== 13.1 InstalaciÃ³n Local
* Node.js requirements
* npm install
* Iniciar n8n
* ConfiguraciÃ³n inicial

=== 13.2 Docker Deployment
* Dockerfile
* docker-compose.yml
* VolÃºmenes
* Redes
* Environment variables

=== 13.3 Deployment en Nube
* AWS (EC2, ECS, Lambda)
* Azure (App Service, Container Instances)
* Google Cloud (Compute Engine, Cloud Run)
* DigitalOcean
* Heroku

=== 13.4 ConfiguraciÃ³n de Base de Datos
* SQLite (default)
* PostgreSQL (producciÃ³n)
* MySQL
* Connection strings
* Migraciones

=== 13.5 ConfiguraciÃ³n de Persistencia
* Almacenamiento de ejecuciones
* Historial de workflows
* Backups
* RestauraciÃ³n

---

== MÃ“DULO 14: Escalabilidad y ProducciÃ³n

=== 14.1 Escalabilidad Horizontal
* Workers
* Multiple instances
* Load balancing
* Queue management

=== 14.2 Performance Optimization
* Caching
* Database indexing
* Workflow optimization
* Resource limits

=== 14.3 Monitoring en ProducciÃ³n
* Logs centralizados
* MÃ©tricas
* Alertas
* Dashboards

=== 14.4 Backup y Disaster Recovery
* Backup estrategia
* Puntos de recuperaciÃ³n
* Testing de restauraciÃ³n
* DocumentaciÃ³n

=== 14.5 Upgrades y Mantenimiento
* Actualizar n8n
* Breaking changes
* Testing en staging
* Rollback plans

---

== MÃ“DULO 15: Extensibilidad

=== 15.1 Custom Nodes
* Estructura de un nodo personalizado
* Crear tu primer custom node
* Propiedades y mÃ©todos
* Publicar nodos

=== 15.2 Comunidad Nodes
* Usar nodos de la comunidad
* Instalar custom nodes
* Recursos comunitarios

=== 15.3 Contribuir a n8n
* Reportar bugs
* Sugerencias de features
* Pull requests
* Comunidad

---

== MÃ“DULO 16: Casos de Estudio

=== 16.1 AutomatizaciÃ³n de RR.HH.
* Registro de empleados
* Notificaciones
* GeneraciÃ³n de reportes
* IntegraciÃ³n con Slack

=== 16.2 E-commerce Avanzado
* GestiÃ³n de pedidos
* SincronizaciÃ³n de inventario
* Notificaciones a clientes
* AnÃ¡lisis de ventas

=== 16.3 Marketing Automation
* Lead scoring
* Email campaigns
* Social media posting
* Analytics

=== 16.4 Data Pipeline
* ExtracciÃ³n de datos
* TransformaciÃ³n
* Carga en warehouse
* Reportes automÃ¡ticos

=== 16.5 Integraciones Complejas
* Multi-service workflows
* Transacciones distribuidas
* CompensaciÃ³n de errores

---

== MÃ“DULO 17: Herramientas Complementarias

=== 17.1 Otras Plataformas de AutomatizaciÃ³n
* Comparativa n8n vs alternativas
* CuÃ¡ndo usar cada una

=== 17.2 Stack TecnolÃ³gico
* n8n + Docker + PostgreSQL
* n8n + Kubernetes
* n8n + CI/CD (GitHub Actions)

=== 17.3 Monitoreo Externo
* Datadog
* New Relic
* Prometheus
* Grafana

---

== MÃ“DULO 18: Proyectos Finales

=== 18.1 Proyecto 1: Sistema de Notificaciones
* IntegraciÃ³n mÃºltiple de canales
* PriorizaciÃ³n de mensajes
* Retry logic
* Dashboard de seguimiento

=== 18.2 Proyecto 2: ETL Pipeline
* ExtracciÃ³n de mÃºltiples fuentes
* TransformaciÃ³n de datos
* ValidaciÃ³n
* Carga en warehouse

=== 18.3 Proyecto 3: CRM Integration Hub
* SincronizaciÃ³n con Salesforce
* Webhooks
* Error handling
* AuditorÃ­a

=== 18.4 Proyecto 4: AutomatizaciÃ³n E-commerce
* IntegraciÃ³n Shopify
* Inventario en tiempo real
* Notificaciones
* Reportes

=== 18.5 Proyecto 5: Platform as a Service
* Multitenancy
* Custom workflows por cliente
* FacturaciÃ³n
* Escalabilidad

---

== Recursos Adicionales

=== DocumentaciÃ³n Oficial
* https://docs.n8n.io/
* Community Forum
* GitHub Repository

=== Comunidad
* Discord Community
* GitHub Issues
* Reddit r/n8n
* YouTube tutorials

=== Herramientas Ãštiles
* n8n CLI
* n8n Desktop
* Node Red (alternativa)
* n8n Cloud (versiÃ³n managed)

---

== Roadmap de Aprendizaje Sugerido

1. **Semana 1**: MÃ³dulos 1-3 (Fundamentos)
2. **Semana 2**: MÃ³dulos 4-5 (Expresiones y Control de Flujo)
3. **Semana 3**: MÃ³dulos 6-7 (Datos y Webhooks)
4. **Semana 4**: MÃ³dulos 8-9 (Casos de Uso y Nodos Avanzados)
5. **Semana 5**: MÃ³dulos 10-11 (Debugging y Seguridad)
6. **Semana 6**: MÃ³dulos 12-13 (IntegraciÃ³n y Deployment)
7. **Semana 7**: MÃ³dulos 14-15 (Escalabilidad y Extensibilidad)
8. **Semana 8**: MÃ³dulos 16-18 (Casos Reales y Proyectos Finales)

---

== ConclusiÃ³n

Este temario proporciona una ruta completa para dominar n8n, desde conceptos bÃ¡sicos hasta implementaciones avanzadas en producciÃ³n. Se recomienda complementar con prÃ¡ctica constante y exploraciÃ³n de la comunidad.

